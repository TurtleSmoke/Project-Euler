<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Project Euler</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Solution of Project Euler problems">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="introduction/purpose.html"><strong aria-hidden="true">1.1.</strong> Purpose</a></li><li class="chapter-item "><a href="introduction/usage.html"><strong aria-hidden="true">1.2.</strong> Usage</a></li><li class="chapter-item "><a href="introduction/contributing.html"><strong aria-hidden="true">1.3.</strong> Contributing</a></li></ol></li><li class="chapter-item expanded "><a href="problems/project_euler.html"><strong aria-hidden="true">2.</strong> Project Euler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0001/problem.html"><strong aria-hidden="true">2.1.</strong> Problem 1: Multiples of 3 and 5</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0001/solution1.html"><strong aria-hidden="true">2.1.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0001/solution2.html"><strong aria-hidden="true">2.1.2.</strong> Three by three</a></li><li class="chapter-item "><a href="problems/problem_0001/solution3.html"><strong aria-hidden="true">2.1.3.</strong> Summing everything</a></li><li class="chapter-item "><a href="problems/problem_0001/solution.html"><strong aria-hidden="true">2.1.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0002/problem.html"><strong aria-hidden="true">2.2.</strong> Problem 2: even Fibonacci numbers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0002/solution1.html"><strong aria-hidden="true">2.2.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0002/solution2.html"><strong aria-hidden="true">2.2.2.</strong> Fibonacci recurrence</a></li><li class="chapter-item "><a href="problems/problem_0002/solution3.html"><strong aria-hidden="true">2.2.3.</strong> Fibonacci and the golden ratio</a></li><li class="chapter-item "><a href="problems/problem_0002/solution.html"><strong aria-hidden="true">2.2.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0003/problem.html"><strong aria-hidden="true">2.3.</strong> Problem 3: Largest prime factor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0003/solution1.html"><strong aria-hidden="true">2.3.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0003/solution2.html"><strong aria-hidden="true">2.3.2.</strong> Two by two</a></li><li class="chapter-item "><a href="problems/problem_0003/solution.html"><strong aria-hidden="true">2.3.3.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0004/problem.html"><strong aria-hidden="true">2.4.</strong> Problem 4: Largest palindrome product</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0004/solution1.html"><strong aria-hidden="true">2.4.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0004/solution2.html"><strong aria-hidden="true">2.4.2.</strong> Factorisation is the key</a></li><li class="chapter-item "><a href="problems/problem_0004/solution3.html"><strong aria-hidden="true">2.4.3.</strong> With pen and paper</a></li><li class="chapter-item "><a href="problems/problem_0004/solution.html"><strong aria-hidden="true">2.4.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0005/problem.html"><strong aria-hidden="true">2.5.</strong> Problem 5: Smallest multiple</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0005/solution1.html"><strong aria-hidden="true">2.5.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0005/solution2.html"><strong aria-hidden="true">2.5.2.</strong> Prime factorization</a></li><li class="chapter-item "><a href="problems/problem_0005/solution3.html"><strong aria-hidden="true">2.5.3.</strong> Least common multiple</a></li><li class="chapter-item "><a href="problems/problem_0005/solution.html"><strong aria-hidden="true">2.5.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0006/problem.html"><strong aria-hidden="true">2.6.</strong> Problem 6: Sum square difference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0006/solution1.html"><strong aria-hidden="true">2.6.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0006/solution2.html"><strong aria-hidden="true">2.6.2.</strong> Summation formula</a></li><li class="chapter-item "><a href="problems/problem_0006/solution.html"><strong aria-hidden="true">2.6.3.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0007/problem.html"><strong aria-hidden="true">2.7.</strong> Problem 7: 10001st prime</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0007/solution1.html"><strong aria-hidden="true">2.7.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0007/solution2.html"><strong aria-hidden="true">2.7.2.</strong> Almost six by six</a></li><li class="chapter-item "><a href="problems/problem_0007/solution3.html"><strong aria-hidden="true">2.7.3.</strong> Prime number theorem</a></li><li class="chapter-item "><a href="problems/problem_0007/solution.html"><strong aria-hidden="true">2.7.4.</strong> Solution</a></li></ol></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Project Euler</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/TurtleSmoke/Project-Euler" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This document gathers explanations on the solutions of the
<a href="https://projecteuler.net">Euler Project</a> exercises.
Each exercise has its own part, which can be discovered in the table of 
contents.
You can find the source code of every solution as well as the source code of my
<a href="https://rust-lang.github.io/mdBook/">mdBook</a> on my <a href="https://github.com/">Github</a>:
<a href="https://github.com/TurtleSmoke/Project-Euler">TurtleSmoke Project Euler</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="purpose"><a class="header" href="#purpose">Purpose</a></h1>
<p>These tutorials are a way to challenge my pedagogical skills as well as my 
(poor) english skills. I want to write small documents explaining simple 
mathematical and algorithmic problems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>You can download each solution and modify it as much as you like. However, 
please do not copy the answer to the Euler project without thinking about it 
first.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>You can contribute as much as you want to the project, for more information
please see <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/README.md">README.md</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproject-eulera"><a class="header" href="#a-hrefhttpsprojecteulernetproject-eulera"><a href="https://projecteuler.net/">Project Euler</a></a></h1>
<h2 id="what-is-project-euler"><a class="header" href="#what-is-project-euler"><strong>What is Project Euler?</strong></a></h2>
<blockquote>
<p>Project Euler is a series of challenging mathematical/computer programming
problems that will require more than just mathematical insights to solve.
Although mathematics will help you arrive at elegant and efficient methods,
the use of a computer and programming skills will be required to solve
most problems.</p>
</blockquote>
<blockquote>
<p>The motivation for starting Project Euler, and its continuation, is to
provide a platform for the inquiring mind to delve into unfamiliar areas
and learn new concepts in a fun and recreational context.</p>
</blockquote>
<h2 id="who-are-the-problems-aimed-at"><a class="header" href="#who-are-the-problems-aimed-at"><strong>Who are the problems aimed at?</strong></a></h2>
<blockquote>
<p>The intended audience include students for whom the basic curriculum is not
feeding their hunger to learn, adults whose background was not primarily
mathematics but had an interest in things mathematical, and professionals
who want to keep their problem solving and mathematics on the cutting edge.</p>
</blockquote>
<blockquote>
<p>Currently we have 1036139 registered members who have solved at least one
problem, representing 220 locations throughout the world, and collectively
using 108 different programming langues to solve the problems.</p>
</blockquote>
<h2 id="can-anyone-solve-the-problems"><a class="header" href="#can-anyone-solve-the-problems"><strong>Can anyone solve the problems?</strong></a></h2>
<blockquote>
<p>The problems range in difficulty and for many the experience is inductive
chain learning. That is, by solving one problem it will expose you to a
new concept that allows you to undertake a previously inaccessible problem.
So the determined participant will slowly but surely work his/her way
through every problem.</p>
</blockquote>
<h2 id="what-next"><a class="header" href="#what-next"><strong>What next?</strong></a></h2>
<blockquote>
<p>In order to track your progress it is necessary to setup an account and
have Cookies enabled.</p>
</blockquote>
<blockquote>
<p>If you already have an account, then Sign In. Otherwise, please Register –
it's completely free!
However, as the problems are challenging, then you may wish to view the
Problems before registering.</p>
</blockquote>
<hr />
<p>Project Euler exists to encourage, challenge, and develop the skills and
enjoyment of anyone with an interest in the fascinating world of mathematics.</p>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem1multiples-of-3-and-5a"><a class="header" href="#a-hrefhttpsprojecteulernetproblem1multiples-of-3-and-5a"><a href="https://projecteuler.net/problem=1">Multiples of 3 and 5</a></a></h1>
<blockquote>
<p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we
get 3, 5, 6 and 9. The sum of these multiples is 23.</p>
</blockquote>
<blockquote>
<p>Find the sum of all the multiples of 3 or 5 below 1000.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force"><a class="header" href="#brute-force">Brute force</a></h1>
<p>The first problem is actually quite easy, the naive solution is to iterate over
each number between 0 and 1000 and check those that are multiples of 3 or 5.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=1000):
    return sum(i for i in range(limit) if i % 3 == 0 or i % 5 == 0)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="three-by-three"><a class="header" href="#three-by-three">Three by three</a></h1>
<p>The <a href="problems/problem_0001/solution1.html">Brute force</a> is actually quite slow, at least it would be if
the limit was greater than 1000. Since only multiples of 3 and 5 are useful,
iterating 3 by 3 and then 5 by 5 will be faster. We have to be careful with the
multiples of 3 and 5 because they will be counted twice. So we have to subtract
them from the result.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=1000):
    sum_3 = sum(i for i in range(0, limit, 3) if i % 3 == 0)
    sum_5 = sum(i for i in range(0, limit, 5) if i % 5 == 0)
    sum_15 = sum(i for i in range(0, limit, 15) if i % 15 == 0)
   
    return sum_3 + sum_5 - sum_15
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summing-everything"><a class="header" href="#summing-everything">Summing everything</a></h1>
<p>The <a href="problems/problem_0001/solution2.html">Three by three</a> solution is quite interesting because it
reduces the problem into smaller parts. For example, the sum of multiples of
three is the following:</p>
<p>\[ 3 + 6 + 9 + 12 + 15 + ... \]
\[ 3 * ( 1 + 2 + 3 + 4 + 5 ...) \]
\[ 3 * \sum_{i=0}^{\lfloor\frac{1000}{3}\rfloor} x_i \]</p>
<p>It is the sum of an arithmetic sequences, which is equal to:</p>
<p>\[ \frac{n*(n+1)}{2} \]</p>
<p>The <a href="problems/problem_0001/solution2.html">Three by three</a> solution can be reduced to:</p>
<p>\[ 3 * \frac{\lfloor\frac{999}{3}\rfloor * (\lfloor\frac{999}{3}\rfloor + 1)}{2} +5 * \frac{\lfloor\frac{999}{5}\rfloor * (\lfloor\frac{999}{5}\rfloor + 1)}{2} -15 * \frac{\lfloor\frac{999}{15}\rfloor * (\lfloor\frac{999}{15}\rfloor + 1)}{2} \]</p>
<p>Note that the limit is 999 because 1000 should not be included.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=999):
    limit_3 = limit // 3
    limit_5 = limit // 5
    limit_15 = limit // 15

    sum_3 = 3 * (limit_3 * (limit_3 + 1) // 2)
    sum_5 = 5 * (limit_5 * (limit_5 + 1) // 2)
    sum_15 = 15 * (limit_15 * (limit_15 + 1) // 2)

    return sum_3 + sum_5 - sum_15
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution"><a class="header" href="#solution">Solution</a></h1>
<hr />
<blockquote>
<p>233168</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem2even-fibonacci-numbersa"><a class="header" href="#a-hrefhttpsprojecteulernetproblem2even-fibonacci-numbersa"><a href="https://projecteuler.net/problem=2">Even Fibonacci numbers</a></a></h1>
<blockquote>
<p>Each new term in the Fibonacci sequence is generated by adding the
previous two terms. By starting with 1 and 2, the first 10 terms will be:</p>
<p align="center"> 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ... </p>
</blockquote>
<blockquote>
<p>By considering the terms in the Fibonacci sequence whose values do not
exceed four million, find the sum of the even-valued terms.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-1"><a class="header" href="#brute-force-1">Brute force</a></h1>
<blockquote>
<p>The <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a> form
a sequence, called the Fibonacci
<a href="https://en.wikipedia.org/wiki/Integer_sequence">sequence</a>, such that each
number is the sum of the two preceding ones, starting from 0 and 1.</p>
</blockquote>
<p>The sum of all even numbers in the Fibonacci sequence less than 4 million can be
calculated quite easily by iterating over the sequence until the threshold is
reached by adding each even number to the result.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    f0 = 1
    f1 = 2
    res = 0
    while f0 &lt; limit:
        if f0 % 2 == 0:
            res += f0
        f0, f1 = f1, f0 + f1

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fibonacci-recurrence"><a class="header" href="#fibonacci-recurrence">Fibonacci recurrence</a></h1>
<p>If we take a look at the Fibonacci series:</p>
<blockquote>
<p>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, ...</p>
</blockquote>
<p>Since our only concern is the parity of the numbers, with O being odd and E
even:</p>
<blockquote>
<p>E, O, O, E, O, O, E, O, O, E, O, O, E, O, O, E, ...</p>
</blockquote>
<h4 id="it-seems-that-every-third-number-of-the-series-is-even-lets-try-to-prove-it-properly"><a class="header" href="#it-seems-that-every-third-number-of-the-series-is-even-lets-try-to-prove-it-properly">It seems that every third number of the series is even, let's try to prove it properly.</a></h4>
<p>\[ \begin{gather} If\ n=0\ then\ F_{0}=0\ is\ even\\\\ Assuming\ that\ F_ {3n} \ is\ even.\\ \\ F_{3( n+1)} =F_{3n+2} +F_{3n+1} =( F_{3n+1} +F_{3n}) +F_{3n+1} =2F_{3n+1} +F_ {3n}\\ \\ Since\ F_{3n} \ is\ even\ and\ 2F_{3n+1} \ is\ also\ even,\ we\ have\ F_{3( n+1)} \ even\\ because\ it\ is\ the\ sum\ of\ two\ even\ numbers. \end{gather} \]</p>
<h4 id="this-mean-that-the-series-of-even-fibonacci-number-is"><a class="header" href="#this-mean-that-the-series-of-even-fibonacci-number-is">This mean that the series of even Fibonacci number is:</a></h4>
<p>\[ \begin {gather} E_{n} = F_{3n}\\ E_{n+2} = F_{3n+6} = F_{3n+5} + F_ {3n+4}\\ E_{n+2} = (F_{3n+4} + F_{3n+3}) + (F_{3n+3} + F_{3n+2})\\ E_{n+2} = (F_{3n+3} + F_{3n+2} + F_{3n+3}) + (F_{3n+3} + F_{3n+1} + F_{3n})\\ E_{n+2} = 3F_{3n+3} + (F_{3n+2} + F_{3n+1}) + F_{3n}\\ E_{n+2} = 4F_{3(n+1)} + F_{3n}\\ E_{n+2} = 4E_{n+1} + E_{n}\\ \end{gather} \]</p>
<h4 id="which-result-int-the-following-recurrence-relation"><a class="header" href="#which-result-int-the-following-recurrence-relation">Which result int the following recurrence relation:</a></h4>
<p>\[ E_{n} = 4E_ {n-1} + E_{n-2} \]</p>
<h4 id="we-are-searching-for"><a class="header" href="#we-are-searching-for">We are searching for:</a></h4>
<p>\[ \sum_{k=1}^ {n}E_k \]</p>
<h4 id="this-can-be-simplified-as-follows"><a class="header" href="#this-can-be-simplified-as-follows">This can be simplified as follows:</a></h4>
<p>\[ \begin{align} \sum_{k=1}^{n}E_ {k+1} &amp;= \sum_{k=1}^{n}4E_{k} + \sum_{k=1} ^{n}E_{k-1}\\ \sum_{k=1}^{n}E_{k}&amp;= \frac{1}{4}(\sum_{k=1}^{n}E_{k+1} - \sum_{k=1}^{n}E_{k-1})\\ &amp;= \frac{1}{4}(\sum_{k=2}^{n+1}E_{k} - \sum_{k=0}^{n-1}E_{k})\\ &amp;= \frac{1}{4}(E_{n+1} + E_{n} - E_1 - E_0)\\ &amp;= \frac{1}{4}(E_{n+1} + E_{n} - 2)\\ \end{align} \]</p>
<p>The result can be calculated by iterating until \( E_{n+1} \) is greater than
the limit, so that \( E_n \) is less than the limit, then apply the previous
function.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    e0 = 0
    e1 = 2
    while e1 &lt; limit:
        e0, e1 = e1, 4 * e1 + e0

    return (e1 + e0 - 2) // 4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fibonacci-and-the-golden-ratio"><a class="header" href="#fibonacci-and-the-golden-ratio">Fibonacci and the golden ratio</a></h1>
<p>Although the number of iterations of the second solution is lower than that of
the first solution, it is possible to do better:</p>
<p>\[ \begin{align} \frac{1}{4}(E_{n+1} + E_{n} - 2) &amp;= \frac{1}{4}(F_{3(n+1)} + F_{3n} - 2)\\ &amp;= \frac{1}{4}(F_{3n+2} + F_{3n+1} + F_{3n} - 2)\\ &amp;= \frac{1}{4}(2F_{3n+2} - 2)\\ &amp;= \frac{1}{2}(F_{3n+2} - 1)\\ \end{align} \]</p>
<p>This does not really change the problem, since we still need to iterate until
\( F_{3n} \) reach the limit and then compute \(\frac{1}{2}(F_
{3n+2} - 1)\).</p>
<p>Actually, the Fibonacci numbers can be approximated with the following
<a href="https://en.wikipedia.org/wiki/Fibonacci_number#Closed-form_expression">equation</a>:</p>
<p>\[ F_{n} = \frac{\varphi^{n} - (-\varphi)^{-n}}{\sqrt{5}} \]</p>
<p>where \( \varphi = \frac{1+\sqrt{5}}{2} \) is the
<a href="https://en.wikipedia.org/wiki/Golden_ratio">golden ratio</a>.</p>
<p>\( -(-\varphi)^{-n} \) can be ignored for large numbers which gives the
equation:</p>
<p>\[ F_{n} = \frac{\varphi^{n}}{\sqrt{5}} \]</p>
<p>The limit is the n-th Fibonacci number such that:</p>
<p>\[ \begin{align} F_{n} &amp;\leqslant M\\ \frac{\varphi ^{n}}{\sqrt{5}} &amp;\leqslant M\\ \varphi ^{n} &amp;\leqslant \sqrt{5} M\\ n\log( \varphi ) &amp;\leqslant \log\left(\sqrt{5} M\right)\\ n &amp;\leqslant \left\lfloor \frac{\log\left(\sqrt{5} M\right)}{\log( \varphi )} \right\rfloor \end{align} \]</p>
<p>The result can be computed with \(\frac{1}{2}(F_{n+2} - 1) \) where \( n =
\left\lfloor \frac{\log\left(\sqrt{5} M\right)}{\log( \varphi )} \right\rfloor
\):</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    golden_ratio = (1 + sqrt(5)) / 2
    n = floor(log(sqrt(5) * limit) / log(golden_ratio))
    fn = round((golden_ratio**(n + 2)) / sqrt(5))

    return (fn - 1) // 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-1"><a class="header" href="#solution-1">Solution</a></h1>
<hr />
<blockquote>
<p>4613732</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem3largest-prime-factora"><a class="header" href="#a-hrefhttpsprojecteulernetproblem3largest-prime-factora"><a href="https://projecteuler.net/problem=3">Largest prime factor</a></a></h1>
<blockquote>
<p>The prime factors of 13195 are 5, 7, 13 and 29.</p>
</blockquote>
<blockquote>
<p>What is the largest prime factor of the number 600851475143 ?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-2"><a class="header" href="#brute-force-2">Brute force</a></h1>
<p>\( i \) is a factor of \( n \) if \( n\ \equiv\ 0\ [i] \), in our case it
is enough to iterate over each number. When a factor is found, we simply divide
\( n \) by that factor and continue as long as \( n \) is greater than one.
When \( n \) is equal to one, we simply return the current factor which is
also the largest.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0003/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_prime_factor(n=600851475143):
    res = 2
    while n != 1:
        if n % res == 0:
            n //= res
        else:
            res += 1

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="two-by-two"><a class="header" href="#two-by-two">Two by Two</a></h1>
<p>Since all primes except 2 are odd and in our case 2 is not a factor of
600851475143, we can start with 3 and iterate two by two, which is not a great
improvement, but this problem has no interesting solution anyway.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0003/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_prime_factor(n=600851475143):
    res = 3
    while n != 1:
        if n % res == 0:
            n //= res
        else:
            res += 2

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-2"><a class="header" href="#solution-2">Solution</a></h1>
<hr />
<blockquote>
<p>6857</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem4largest-palindrome-producta"><a class="header" href="#a-hrefhttpsprojecteulernetproblem4largest-palindrome-producta"><a href="https://projecteuler.net/problem=4">Largest palindrome product</a></a></h1>
<blockquote>
<p>A palindromic number reads the same both ways. The largest palindrome made
from the product of two 3-digit numbers is 9009 = 91 × 99.</p>
</blockquote>
<blockquote>
<p>Find the largest palindrome made from the product of two 3-digit numbers.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-3"><a class="header" href="#brute-force-3">Brute force</a></h1>
<p>We are searching the largest palindrome made from the product of two 3-digit
numbers. Firstly, it is necessary to know when a number is a palindrome. This
can be done easily using python iteration.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def is_palindrome(n):
    return str(n) == str(n)[::-1]
</code></pre>
<p>A better solution exists using modulus and division, but performance is not the
goal here.</p>
<p>The range of 3-digit numbers is \( [100; 999] \), the naive solution will
consist in simply iterate over each number and check which product is the
largest palindrome. A little trick: if \( 100 * 200 \) does not work, \(
200 * 100 \) won't work either, so the second loop starts from the current
number of the first one.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_palindrome_product():
    res = 0
    for x in range(100, 1000):
        for y in range(x, 1000):
            if x * y &gt; res and is_palindrome(x * y):
                res = x * y
                
    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="factorisation-is-the-key"><a class="header" href="#factorisation-is-the-key">Factorisation is the key</a></h1>
<p>We know that the researched number is larger than \( 100*100 = 10000 \)
and smaller than \( 999*999 = 998001 \). So it must be of the form \(
abcba \) or \( abccba \). Let's assume it is of the form \( abccba \), if
it does not work, we'll try with \( abcba \).</p>
<p>\( abccba = 10001a + 10010b + 1100c = 11(9091a + 910b + 100c) \) which means
that the palindrome must be divisible by 11. Since 11 is prime, either \(
100001a \), \( 10010b \) or \( 1100c \) is a multiple of 11, which is why
the iteration can be done 11 by 11.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_palindrome_product():
    res = 0
    for x in range(110, 1000, 11):
        for y in range(x, 1000):
            if x * y &gt; res and is_palindrome(x * y):
                res = x * y

    return res
</code></pre>
<p>We went from 405450 iterations with the <a href="problems/problem_0004/solution1.html">Brute force</a> to 36450
iterations !</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="with-pen-and-paper"><a class="header" href="#with-pen-and-paper">With pen and paper</a></h1>
<p>In <a href="problems/problem_0004/solution2.html">Factorisation is the key</a>, we assume that the number was of
the form \( abccba \). Since it is the factor of two 3-digit number, we have :</p>
<p>\[ \begin{align} abccba &amp;= (100a + 10b + c)(100d + 10e + f)\\ &amp;= 10000ad + 1000(bd + ae) + 100(cd + be + af) + 10(ce + bf) + cf \end{align} \]</p>
<p>Assuming the first digit is 9, then \( cf \) must be equal to 9 as well.</p>
<p>The only ways to make the last digit nine are:</p>
<p>\[ 1 * 9\\ 3 * 3\\ 7 * 7 \]</p>
<p>Thus, both number must start with 9 and end with either 1, 3, 7 or 9. We also
know that \( 100a + 10b + c \) or \( 100d + 10e + f \) is divisible by 11.
The only numbers divisible by 11 and ending with 1, 3, 7 or 9 in the
\( [900; 999]
\) are :</p>
<p>\[ 913\\ 957\\ 979 \]</p>
<p>This give us:</p>
<p>\[ \text{a = 9}\\ \text{b = 1, 5 or 7}\\ \text{c = 3, 7 or 9}\\ \]</p>
<p>Resulting in the numbers:</p>
<p>\[
(900 + 10 + 3)(900 + 10e + 3) = 824439 + 9130x\\
(900 + 50 + 7)(900 + 10e + 7) = 867999 + 9570x\\
(900 + 70 + 9)(900 + 10e + 1) = 882079 + 9790x \]</p>
<p>The first number implies that \( e \) is equal to 9 because if \( e \) was
equal to 8, then \(824439 * 9130 * 8 = 897479 \) would not start with 9.
With \( e = 9 \) we have \( 913 * 993 \) which is the correct answer. Both
\( (900 + 50 + 7)(900 + 10e + 7) \) and \( (900 + 70 + 9)(900 + 10e + 1) \)
give smaller palindrome.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-3"><a class="header" href="#solution-3">Solution</a></h1>
<hr />
<blockquote>
<p>906609</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem5smallest-multiplea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem5smallest-multiplea"><a href="https://projecteuler.net/problem=5">Smallest multiple</a></a></h1>
<blockquote>
<p>2520 is the smallest number that can be divided by each of the numbers
from 1 to 10 without any remainder.</p>
</blockquote>
<blockquote>
<p>What is the smallest positive number that is evenly divisible by all of
the numbers from 1 to 20?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-4"><a class="header" href="#brute-force-4">Brute force</a></h1>
<p>As always, the brute force solution is quite simple, first determine if a number
is evenly divisible by all numbers from 1 to 20.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def is_evenly_divisible(n):
    for i in range(1, 21):
        if n % i != 0:
            return False
        
    return True
</code></pre>
<p>Then iterate until you find a solution.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def smallest_multiple():
    i = 1
    while not is_evenly_divisible(i):
        i += 1

    return i
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime-factorization"><a class="header" href="#prime-factorization">Prime factorization</a></h1>
<p>The <a href="problems/problem_0005/solution2.html">Brute force</a> is actually very slow. A better solution can be
found using prime factorization. The key is to understand that when \( x \)
divides \( y \) evenly, it is because the prime factors of \( x\) are
contained in \( y \). For example, \( 20 = 2^2 * 5 \) which means that a
number divisible by 20 is also divisible by 2, 4 and 5.</p>
<p>Calculating the prime factorization of each number from 1 to 20 give us:</p>
<p>\[\begin{align} 20 &amp;= 2^2 * 5\\ 19 &amp;= 19\\ 18 &amp;= 2 * 3^2\\ 17 &amp;= 17\\ 16 &amp;= 2^4\\ 15 &amp;= 3 * 5\\ 14 &amp;= 2 * 7\\ 13 &amp;= 13\\ 12 &amp;= 2^2 * 3\\ 11 &amp;= 11\\ \end{align} \]</p>
<p>We can stop here, because 10 is included in 20, 9 in 18, 8 in 16, 7 in 14, 6 in
12, 5 in 20, 4 in 20, 3 in 18, 2 in 20 and 1 in 20.</p>
<p>It gives us the answer: \( 2^4 * 3^2 * 5 * 7 * 11 * 13 * 17 * 19 =
232792560 \).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="least-common-multiple"><a class="header" href="#least-common-multiple">Least common multiple</a></h1>
<p>Actually, the problem is to find
the <a href="https://en.wikipedia.org/wiki/Least_common_multiple#Reduction_by_the_greatest_common_divisor">least common multiple</a>
which is:</p>
<p>\[ LCT(1, 2, ..., N) \]</p>
<p>To find the \( LCT \) of \( 1 \) through \( N \), we need all the primes
\( \leqslant N \). For each prime, we need its maximum power that won't exceed
\( N \). Which can be done easily using logarithms:</p>
<p>\[ \begin{align} p^{k} &amp;\leqslant N\\ k\log( p) &amp;\leqslant \log( N)\\ k&amp;=\left\lfloor \frac{\log( N)}{\log( p)}\right\rfloor\\ \end{align} \]</p>
<p>So the \( LCT \) of \( 1 \) through \( N \) is:</p>
<p>\[ \prod p^{\left\lfloor \frac{\log(N)}{\log(p)} \right\rfloor } \]</p>
<p>We also know that it's pointless to search the maximum power of primes greater
than \( \sqrt{n} \) because it will always be 1.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def smallest_multiple(n=20):
    # Returns a list of all primes &lt;= n
    primes = sieve.primerange(n + 1)
    sqrt_n, log_n = sqrt(n), log(n)
    res = 1
    for p in primes:
        if p &lt; sqrt_n:
            res *= p**(floor(log_n / log(p)))
        else:
            res *= p

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-4"><a class="header" href="#solution-4">Solution</a></h1>
<hr />
<blockquote>
<p>232792560</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem6sum-square-differencea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem6sum-square-differencea"><a href="https://projecteuler.net/problem=6">Sum square difference</a></a></h1>
<blockquote>
<p>The sum of the squares of the first ten natural numbers is,
\[ 1^2 + 2^2 +...+10^2=385 \]
The square of the sum of the first ten natural number is,
\[ (1+2+...10)^2 = 3025 \]
Hence the difference between the sum of the squares of the first ten
natural numbers and the square of the sum is \( 3025 - 385 = 2640 \)</p>
</blockquote>
<blockquote>
<p>Find the difference between the sum of the squares of the first one 
hundred natural numbers and the square of the sum.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-5"><a class="header" href="#brute-force-5">Brute force</a></h1>
<p>Finding the difference between the sum of the squares and the square of the sum
required two steps:</p>
<p>Find the sum of the squares:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_squares(n):
    return sum(i**2 for i in range(1, n + 1))
</code></pre>
<p>And the square of the sum:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def square_of_sum(n):
    return sum(i for i in range(1, n + 1))**2
</code></pre>
<p>Finally, just subtract the square of the sum by the sum of the squares:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_square_difference(n=100):
    return square_of_sum(n) - sum_of_squares(n)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summation-formula"><a class="header" href="#summation-formula">Summation formula</a></h1>
<p>We learned in <a href="problems/problem_0006/../problem_0001/problem.html">Problem 1: Multiples of 3 and 5</a>
that:</p>
<p>\[ \sum{k} = \frac{n(n+1)}{2} \]</p>
<p>This gives the following formula for the square of the sum:</p>
<p>\[ (1+2+...+10)^2 = \left(\sum{k}\right)^2 = \left(\frac{n(n+1)}{2}\right)^2 = \frac{n^2 (n+1)^2}{4} \]</p>
<p>The sum of the squares can be found using the formula:</p>
<p>\[ \sum{k^2} = \frac{n(n+1)(2n+1)}{6} \]</p>
<p>There are many demonstrations to prove this equation, let's just look at one of
them:</p>
<p>\[ \begin{align} ( k-1)^{3} &amp;=k^{3} -3k^{2} +3k-1\\ k^{3} -( k-1)^{3} &amp;=3k^{2} -3k+1\\ \sum _{k=1}^{n}\left( k^{3} -( k-1)^{3}\right) &amp;=\sum _{k=1}^{n} 3k^{2} -3k+1 \\ \sum _{k=1}^{n} k^{3} -\sum _{k=1}^{n}( k-1)^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\sum _{k=1}^{n} k+\sum _{k=1}^{n} 1\\ \sum _{k=1}^{n} k^{3} -\sum _{k=0}^{n-1} k^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\frac{n( n+1)}{2} +n\\ n^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\frac{n( n+1)}{2} +n\\ \sum _{k=1}^{n} k^{2} &amp;=\frac{1}{3} n^{3} +\frac{n( n+1)}{2} -\frac{1}{3} n\\ \sum _{k=1}^{n} k^{2} &amp;=\frac{n( n+1)( 2n+1)}{6} \end{align} \]</p>
<p>The solution can be found in constant time with these two equations:</p>
<p>\[ \frac{n^2(n+1)^2}{4} - \frac{n(n+1)(2n+1)}{6} = \frac{3n^4+2n^3-3n^2-2n}{12} \]</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_square_difference(n=100):
    return (3 * n**4 + 2 * n**3 - 3 * n**2 - 2 * n) // 12
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-5"><a class="header" href="#solution-5">Solution</a></h1>
<hr />
<blockquote>
<p>25164150</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem710001st-primea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem710001st-primea"><a href="https://projecteuler.net/problem=7">10001st prime</a></a></h1>
<blockquote>
<p>By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can see that the 6th prime is 13.</p>
</blockquote>
<blockquote>
<p>What is the 10 001st prime number?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-6"><a class="header" href="#brute-force-6">Brute force</a></h1>
<p>A well known and fast way to generate primes is the
<a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve of Eratosthenes</a>.
The only problem is that we need an upper bound, which is not the case here
since we don't know the size of the 10001st prime.</p>
<p>We will have to test the primality of each number, if it is prime, then we store
it, otherwise we continue with the next number until the list of prime numbers
that we stored contains 10001 elements. The last one being the answer.</p>
<p>To determine the primality of a number, we can check if one of the preceding
primes can divide it, if not, the number is prime.</p>
<p>Since even number can not be prime, we can go two by two just like
the <a href="problems/problem_0007/../problem_0003/solution2.html">Two by Two</a> solution
of <a href="problems/problem_0007/../problem_0003/problem.html">Problem 3: Largest prime factor</a>.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    i = 3
    primes = [2]
    while len(primes) &lt; n:
        if all(i % p != 0 for p in primes):  # No divisor in the previous prime.
            primes.append(i)
        i += 2

    return primes[-1]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="almost-six-by-six"><a class="header" href="#almost-six-by-six">Almost six by six</a></h1>
<p>Actually, it is possible to speed up a little the previous program knowing that
every prime \( n &gt; 3 \) is of the form :</p>
<p>\[ 6k+1 \text{ or } 6k-1 \]</p>
<p>Let's try to persuade ourselves that this is true. All prime numbers are of the
form:</p>
<p>\[ 6k - 1\\ 6k\\ 6k+1\\ 6k+2\\ 6k+3\\ 6k+4\\ \]</p>
<p>Nothing amazing, but as we are looking for prime number, we can remove some of
them :</p>
<p>\( 6k \), \( 6k + 2 \) and \( 6k + 4 \) are even number, so they cannot be
prime.</p>
<p>\( 6k + 3 = 3(3k + 1) \) which is divisible by 3 and thus not prime
(except 3).</p>
<p>Which let us with: \( 6k + 1 \) and \( 6k - 1 \).</p>
<p>Thus, we can rewrite the old program to check only those numbers.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    i = 1
    primes = [2, 3]
    while len(primes) &lt; n:
        if all((6 * i - 1) % p != 0 for p in primes):
            primes.append(6 * i - 1)
        if all((6 * i + 1) % p != 0 for p in primes):
            primes.append(6 * i + 1)
        i += 1

    return primes[n - 1]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime-number-theorem"><a class="header" href="#prime-number-theorem">Prime number theorem</a></h1>
<p>As I said in the <a href="problems/problem_0007/solution1.html">Brute force</a> solution, the fasted way to
generate primes is the sieve of eratosthenes, but it requires an upper bound. We
can not find the exact upper bound, but we can have a good approximation using
the <a href="https://en.wikipedia.org/wiki/Prime_number_theorem">Prime number theorem</a>:</p>
<p>\[  \pi(N) \sim \frac{N}{\log(N)} \]</p>
<p>Where \( \pi(N) \) is the
<a href="https://en.wikipedia.org/wiki/Prime-counting_function">prime-counting function</a>
.</p>
<p>This function give the number of primes \( M \) less than or equal to \( N
\), in our case we want to determine \( N \) knowing \( M \). Which give us
another formula:</p>
<p>\[ \begin{align} \frac{N}{\log(N)} &amp;\leqslant M\\ \frac{\log(N)}{N} &amp;\leqslant \frac{1}{M}\\ -\frac{\log(N)}{N} &amp;\leqslant -\frac{1}{M}\\ -\frac{\log(N)}{e^{\log(N)}} &amp;\leqslant -\frac{1}{M}\\ -\log(N)e^{-\log(N)} &amp;\leqslant -\frac{1}{M} \end{align} \]</p>
<p>The <a href="https://en.wikipedia.org/wiki/Lambert_W_function">Lambert \( W \) function</a>
says that \( we^w = z \Leftrightarrow w = \mathit{W}_{k}(z) \). This give us:</p>
<p>\[ \begin{align} -\log( N) e^{-\log( N)} &amp;\leqslant -\frac{1}{M}\\ -\log( N) &amp;\leqslant W_{k}\left( -\frac{1}{M}\right)\\ N &amp;\leqslant e^{-W_{k}\left( -\frac{1}{M}\right)} \end{align} \]</p>
<p>The solutions of Lambert's \( W \) function with real number can be found with
ony two branches: \( W_0 \) and \( W_{-1} \) suffice.</p>
<p>For real number \( z \) and \( w \) the equation \( we^w = z \) can be
solved for \( w \) only if \( w \geqslant -\frac{1}{e} \). if \( z
\geqslant 0 \) we get \( w = W_0(z) \) and the two values \( w = W_0(z) \)
and \( w = W_{-1}(z) \) if \( -\frac{1}{e} \leqslant w &lt; 0 \).</p>
<p>We have \( w = -\log(N) \) so we are in the second case. We need to determine
which of \(W_0(z) \) and \( W_{-1}(z) \) is the right formula.</p>
<p>The branch 0 converge to 1 when \( z \) converge to 0. Actually, for \( M &gt;
3 \) we have \( \lceil W_k(-\frac{1}{M}) \rceil = 1\). It implies that the
good branch is -1.</p>
<p>We can actually build the sieve of eratosthenes with the upper bound \( e^ {-W_
{-1}(-\frac{1}{M})} \). Lambert's \( W \) function cannot be expressed in
terms of
<a href="https://en.wikipedia.org/wiki/Elementary_function">elementary functions</a>, so
the formula cannot be simplified. The value of Lambert's \( W \) function
requires an iterative method to be found, as this is quite a difficult problem
we will use the
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.lambertw.html">lambertw</a>
from <a href="https://docs.scipy.org/doc/scipy/index.html">scipy</a> to determine our upper
bound.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    if n &lt; 3:
        return [2, 3][n - 1]

    limit_pi_1 = ceil(exp(-lambertw(-1 / n, -1).real))
    primes = sieve.primerange(limit_pi_1 + 1)

    return next(islice(primes, n - 1, n))
</code></pre>
<p>Note that <code>sieve.primerange</code> returns a <code>generator</code>, so we use slice to get the
n-th element.</p>
<p>When \( N &lt; 3 \), we have \( -\log(N) \geqslant -\frac{1}{e} \) which means
the Lambert's W function has no solution. We can simply hard-code the case of 1
and 2.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-6"><a class="header" href="#solution-6">Solution</a></h1>
<hr />
<blockquote>
<p>104743</p>
</blockquote>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
                
    </body>
</html>
