<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Project Euler</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Solution of Project Euler problems">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="introduction/purpose.html"><strong aria-hidden="true">1.1.</strong> Purpose</a></li><li class="chapter-item "><a href="introduction/usage.html"><strong aria-hidden="true">1.2.</strong> Usage</a></li><li class="chapter-item "><a href="introduction/contributing.html"><strong aria-hidden="true">1.3.</strong> Contributing</a></li></ol></li><li class="chapter-item expanded "><a href="problems/project_euler.html"><strong aria-hidden="true">2.</strong> Project Euler</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0001/problem.html"><strong aria-hidden="true">2.1.</strong> Problem 1: Multiples of 3 and 5</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0001/solution1.html"><strong aria-hidden="true">2.1.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0001/solution2.html"><strong aria-hidden="true">2.1.2.</strong> Three by three</a></li><li class="chapter-item "><a href="problems/problem_0001/solution3.html"><strong aria-hidden="true">2.1.3.</strong> Summing everything</a></li><li class="chapter-item "><a href="problems/problem_0001/solution.html"><strong aria-hidden="true">2.1.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0002/problem.html"><strong aria-hidden="true">2.2.</strong> Problem 2: even Fibonacci numbers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0002/solution1.html"><strong aria-hidden="true">2.2.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0002/solution2.html"><strong aria-hidden="true">2.2.2.</strong> Fibonacci recurrence</a></li><li class="chapter-item "><a href="problems/problem_0002/solution3.html"><strong aria-hidden="true">2.2.3.</strong> Fibonacci and the golden ratio</a></li><li class="chapter-item "><a href="problems/problem_0002/solution.html"><strong aria-hidden="true">2.2.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0003/problem.html"><strong aria-hidden="true">2.3.</strong> Problem 3: Largest prime factor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0003/solution1.html"><strong aria-hidden="true">2.3.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0003/solution2.html"><strong aria-hidden="true">2.3.2.</strong> Two by two</a></li><li class="chapter-item "><a href="problems/problem_0003/solution.html"><strong aria-hidden="true">2.3.3.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0004/problem.html"><strong aria-hidden="true">2.4.</strong> Problem 4: Largest palindrome product</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0004/solution1.html"><strong aria-hidden="true">2.4.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0004/solution2.html"><strong aria-hidden="true">2.4.2.</strong> Factorisation is the key</a></li><li class="chapter-item "><a href="problems/problem_0004/solution3.html"><strong aria-hidden="true">2.4.3.</strong> With pen and paper</a></li><li class="chapter-item "><a href="problems/problem_0004/solution.html"><strong aria-hidden="true">2.4.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0005/problem.html"><strong aria-hidden="true">2.5.</strong> Problem 5: Smallest multiple</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0005/solution1.html"><strong aria-hidden="true">2.5.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0005/solution2.html"><strong aria-hidden="true">2.5.2.</strong> Prime factorization</a></li><li class="chapter-item "><a href="problems/problem_0005/solution3.html"><strong aria-hidden="true">2.5.3.</strong> Least common multiple</a></li><li class="chapter-item "><a href="problems/problem_0005/solution.html"><strong aria-hidden="true">2.5.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0006/problem.html"><strong aria-hidden="true">2.6.</strong> Problem 6: Sum square difference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0006/solution1.html"><strong aria-hidden="true">2.6.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0006/solution2.html"><strong aria-hidden="true">2.6.2.</strong> Summation formula</a></li><li class="chapter-item "><a href="problems/problem_0006/solution.html"><strong aria-hidden="true">2.6.3.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0007/problem.html"><strong aria-hidden="true">2.7.</strong> Problem 7: 10001st prime</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0007/solution1.html"><strong aria-hidden="true">2.7.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0007/solution2.html"><strong aria-hidden="true">2.7.2.</strong> Almost six by six</a></li><li class="chapter-item "><a href="problems/problem_0007/solution3.html"><strong aria-hidden="true">2.7.3.</strong> Prime number theorem</a></li><li class="chapter-item "><a href="problems/problem_0007/solution.html"><strong aria-hidden="true">2.7.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0008/problem.html"><strong aria-hidden="true">2.8.</strong> Problem 8: Largest product in a series</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0008/solution1.html"><strong aria-hidden="true">2.8.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0008/solution2.html"><strong aria-hidden="true">2.8.2.</strong> 0 are useless</a></li><li class="chapter-item "><a href="problems/problem_0008/solution.html"><strong aria-hidden="true">2.8.3.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0009/problem.html"><strong aria-hidden="true">2.9.</strong> Problem 9: Special Pythagorean triplet</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0009/solution1.html"><strong aria-hidden="true">2.9.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0009/solution2.html"><strong aria-hidden="true">2.9.2.</strong> With a little thought</a></li><li class="chapter-item "><a href="problems/problem_0009/solution3.html"><strong aria-hidden="true">2.9.3.</strong> Prime Pythagorean triples</a></li><li class="chapter-item "><a href="problems/problem_0009/solution.html"><strong aria-hidden="true">2.9.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0010/problem.html"><strong aria-hidden="true">2.10.</strong> Problem 10: Summation of primes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0010/solution1.html"><strong aria-hidden="true">2.10.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0010/solution2.html"><strong aria-hidden="true">2.10.2.</strong> Summation minus summation</a></li><li class="chapter-item "><a href="problems/problem_0010/solution3.html"><strong aria-hidden="true">2.10.3.</strong> Dynamic programming</a></li><li class="chapter-item "><a href="problems/problem_0010/solution.html"><strong aria-hidden="true">2.10.4.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0011/problem.html"><strong aria-hidden="true">2.11.</strong> Problem 11: Largest product in a grid</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0011/solution1.html"><strong aria-hidden="true">2.11.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0011/solution.html"><strong aria-hidden="true">2.11.2.</strong> Solution</a></li></ol></li><li class="chapter-item "><a href="problems/problem_0012/problem.html"><strong aria-hidden="true">2.12.</strong> Problem 12: Highly divisible triangular number</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="problems/problem_0012/solution1.html"><strong aria-hidden="true">2.12.1.</strong> Brute force</a></li><li class="chapter-item "><a href="problems/problem_0012/solution2.html"><strong aria-hidden="true">2.12.2.</strong> Common factor</a></li><li class="chapter-item "><a href="problems/problem_0012/solution.html"><strong aria-hidden="true">2.12.3.</strong> Solution</a></li></ol></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Project Euler</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/TurtleSmoke/Project-Euler" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This document gathers explanations on the solutions of the
<a href="https://projecteuler.net">Euler Project</a> exercises.
Each exercise has its own part, which can be discovered in the table of 
contents.
You can find the source code of every solution as well as the source code of my
<a href="https://rust-lang.github.io/mdBook/">mdBook</a> on my <a href="https://github.com/">Github</a>:
<a href="https://github.com/TurtleSmoke/Project-Euler">TurtleSmoke Project Euler</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="purpose"><a class="header" href="#purpose">Purpose</a></h1>
<p>These tutorials are a way to challenge my pedagogical skills as well as my 
(poor) english skills. I want to write small documents explaining simple 
mathematical and algorithmic problems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>You can download each solution and modify it as much as you like. However, 
please do not copy the answer to the Euler project without thinking about it 
first.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>You can contribute as much as you want to the project, for more information
please see <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/README.md">README.md</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproject-eulera"><a class="header" href="#a-hrefhttpsprojecteulernetproject-eulera"><a href="https://projecteuler.net/">Project Euler</a></a></h1>
<h2 id="what-is-project-euler"><a class="header" href="#what-is-project-euler"><strong>What is Project Euler?</strong></a></h2>
<blockquote>
<p>Project Euler is a series of challenging mathematical/computer programming
problems that will require more than just mathematical insights to solve.
Although mathematics will help you arrive at elegant and efficient methods,
the use of a computer and programming skills will be required to solve
most problems.</p>
</blockquote>
<blockquote>
<p>The motivation for starting Project Euler, and its continuation, is to
provide a platform for the inquiring mind to delve into unfamiliar areas
and learn new concepts in a fun and recreational context.</p>
</blockquote>
<h2 id="who-are-the-problems-aimed-at"><a class="header" href="#who-are-the-problems-aimed-at"><strong>Who are the problems aimed at?</strong></a></h2>
<blockquote>
<p>The intended audience include students for whom the basic curriculum is not
feeding their hunger to learn, adults whose background was not primarily
mathematics but had an interest in things mathematical, and professionals
who want to keep their problem solving and mathematics on the cutting edge.</p>
</blockquote>
<blockquote>
<p>Currently we have 1036139 registered members who have solved at least one
problem, representing 220 locations throughout the world, and collectively
using 108 different programming langues to solve the problems.</p>
</blockquote>
<h2 id="can-anyone-solve-the-problems"><a class="header" href="#can-anyone-solve-the-problems"><strong>Can anyone solve the problems?</strong></a></h2>
<blockquote>
<p>The problems range in difficulty and for many the experience is inductive
chain learning. That is, by solving one problem it will expose you to a
new concept that allows you to undertake a previously inaccessible problem.
So the determined participant will slowly but surely work his/her way
through every problem.</p>
</blockquote>
<h2 id="what-next"><a class="header" href="#what-next"><strong>What next?</strong></a></h2>
<blockquote>
<p>In order to track your progress it is necessary to setup an account and
have Cookies enabled.</p>
</blockquote>
<blockquote>
<p>If you already have an account, then Sign In. Otherwise, please Register –
it's completely free!
However, as the problems are challenging, then you may wish to view the
Problems before registering.</p>
</blockquote>
<hr />
<p>Project Euler exists to encourage, challenge, and develop the skills and
enjoyment of anyone with an interest in the fascinating world of mathematics.</p>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem1multiples-of-3-and-5a"><a class="header" href="#a-hrefhttpsprojecteulernetproblem1multiples-of-3-and-5a"><a href="https://projecteuler.net/problem=1">Multiples of 3 and 5</a></a></h1>
<blockquote>
<p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we
get 3, 5, 6 and 9. The sum of these multiples is 23.</p>
</blockquote>
<blockquote>
<p>Find the sum of all the multiples of 3 or 5 below 1000.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force"><a class="header" href="#brute-force">Brute force</a></h1>
<p>The first problem is actually quite easy, the naive solution is to iterate over
each number between 0 and 1000 and check those that are multiples of 3 or 5.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=1000):
    return sum(i for i in range(limit) if i % 3 == 0 or i % 5 == 0)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="three-by-three"><a class="header" href="#three-by-three">Three by three</a></h1>
<p>The <a href="problems/problem_0001/solution1.html">Brute force</a> is actually quite slow, at least it would be if
the limit was greater than 1000. Since only multiples of 3 and 5 are useful,
iterating 3 by 3 and then 5 by 5 will be faster. We have to be careful with the
multiples of 3 and 5 because they will be counted twice. So we have to subtract
them from the result.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=1000):
    sum_3 = sum(i for i in range(0, limit, 3) if i % 3 == 0)
    sum_5 = sum(i for i in range(0, limit, 5) if i % 5 == 0)
    sum_15 = sum(i for i in range(0, limit, 15) if i % 15 == 0)
   
    return sum_3 + sum_5 - sum_15
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summing-everything"><a class="header" href="#summing-everything">Summing everything</a></h1>
<p>The <a href="problems/problem_0001/solution2.html">Three by three</a> solution is quite interesting because it
reduces the problem into smaller parts. For example, the sum of multiples of
three is the following:</p>
<p>\[ 3 + 6 + 9 + 12 + 15 + ... \]
\[ 3 * ( 1 + 2 + 3 + 4 + 5 ...) \]
\[ 3 * \sum_{i=0}^{\lfloor\frac{1000}{3}\rfloor} x_i \]</p>
<p>It is the sum of an arithmetic sequences, which is equal to:</p>
<p>\[ \frac{n*(n+1)}{2} \]</p>
<p>The <a href="problems/problem_0001/solution2.html">Three by three</a> solution can be reduced to:</p>
<p>\[ 3 * \frac{\lfloor\frac{999}{3}\rfloor * (\lfloor\frac{999}{3}\rfloor + 1)}{2} +5 * \frac{\lfloor\frac{999}{5}\rfloor * (\lfloor\frac{999}{5}\rfloor + 1)}{2} -15 * \frac{\lfloor\frac{999}{15}\rfloor * (\lfloor\frac{999}{15}\rfloor + 1)}{2} \]</p>
<p>Note that the limit is 999 because 1000 should not be included.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0001/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def sum_of_three_and_five(limit=999):
    limit_3 = limit // 3
    limit_5 = limit // 5
    limit_15 = limit // 15

    sum_3 = 3 * (limit_3 * (limit_3 + 1) // 2)
    sum_5 = 5 * (limit_5 * (limit_5 + 1) // 2)
    sum_15 = 15 * (limit_15 * (limit_15 + 1) // 2)

    return sum_3 + sum_5 - sum_15
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution"><a class="header" href="#solution">Solution</a></h1>
<hr />
<blockquote>
<p>233168</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem2even-fibonacci-numbersa"><a class="header" href="#a-hrefhttpsprojecteulernetproblem2even-fibonacci-numbersa"><a href="https://projecteuler.net/problem=2">Even Fibonacci numbers</a></a></h1>
<blockquote>
<p>Each new term in the Fibonacci sequence is generated by adding the
previous two terms. By starting with 1 and 2, the first 10 terms will be:</p>
<p align="center"> 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ... </p>
</blockquote>
<blockquote>
<p>By considering the terms in the Fibonacci sequence whose values do not
exceed four million, find the sum of the even-valued terms.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-1"><a class="header" href="#brute-force-1">Brute force</a></h1>
<blockquote>
<p>The <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a> form
a sequence, called the Fibonacci
<a href="https://en.wikipedia.org/wiki/Integer_sequence">sequence</a>, such that each
number is the sum of the two preceding ones, starting from 0 and 1.</p>
</blockquote>
<p>The sum of all even numbers in the Fibonacci sequence less than 4 million can be
calculated quite easily by iterating over the sequence until the threshold is
reached by adding each even number to the result.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    f0 = 1
    f1 = 2
    res = 0
    while f0 &lt; limit:
        if f0 % 2 == 0:
            res += f0
        f0, f1 = f1, f0 + f1

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fibonacci-recurrence"><a class="header" href="#fibonacci-recurrence">Fibonacci recurrence</a></h1>
<p>If we take a look at the Fibonacci series:</p>
<blockquote>
<p>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, ...</p>
</blockquote>
<p>Since our only concern is the parity of the numbers, with O being odd and E
even:</p>
<blockquote>
<p>E, O, O, E, O, O, E, O, O, E, O, O, E, O, O, E, ...</p>
</blockquote>
<h4 id="it-seems-that-every-third-number-of-the-series-is-even-lets-try-to-prove-it-properly"><a class="header" href="#it-seems-that-every-third-number-of-the-series-is-even-lets-try-to-prove-it-properly">It seems that every third number of the series is even, let's try to prove it properly.</a></h4>
<p>\[ \begin{gather} If\ n=0\ then\ F_{0}=0\ is\ even\\\\ Assuming\ that\ F_ {3n} \ is\ even.\\ \\ F_{3( n+1)} =F_{3n+2} +F_{3n+1} =( F_{3n+1} +F_{3n}) +F_{3n+1} =2F_{3n+1} +F_ {3n}\\ \\ Since\ F_{3n} \ is\ even\ and\ 2F_{3n+1} \ is\ also\ even,\ we\ have\ F_{3( n+1)} \ even\\ because\ it\ is\ the\ sum\ of\ two\ even\ numbers. \end{gather} \]</p>
<h4 id="this-mean-that-the-series-of-even-fibonacci-number-is"><a class="header" href="#this-mean-that-the-series-of-even-fibonacci-number-is">This mean that the series of even Fibonacci number is:</a></h4>
<p>\[ \begin {gather} E_{n} = F_{3n}\\ E_{n+2} = F_{3n+6} = F_{3n+5} + F_ {3n+4}\\ E_{n+2} = (F_{3n+4} + F_{3n+3}) + (F_{3n+3} + F_{3n+2})\\ E_{n+2} = (F_{3n+3} + F_{3n+2} + F_{3n+3}) + (F_{3n+3} + F_{3n+1} + F_{3n})\\ E_{n+2} = 3F_{3n+3} + (F_{3n+2} + F_{3n+1}) + F_{3n}\\ E_{n+2} = 4F_{3(n+1)} + F_{3n}\\ E_{n+2} = 4E_{n+1} + E_{n}\\ \end{gather} \]</p>
<h4 id="which-result-int-the-following-recurrence-relation"><a class="header" href="#which-result-int-the-following-recurrence-relation">Which result int the following recurrence relation:</a></h4>
<p>\[ E_{n} = 4E_ {n-1} + E_{n-2} \]</p>
<h4 id="we-are-searching-for"><a class="header" href="#we-are-searching-for">We are searching for:</a></h4>
<p>\[ \sum_{k=1}^ {n}E_k \]</p>
<h4 id="this-can-be-simplified-as-follows"><a class="header" href="#this-can-be-simplified-as-follows">This can be simplified as follows:</a></h4>
<p>\[ \begin{align} \sum_{k=1}^{n}E_ {k+1} &amp;= \sum_{k=1}^{n}4E_{k} + \sum_{k=1} ^{n}E_{k-1}\\ \sum_{k=1}^{n}E_{k}&amp;= \frac{1}{4}(\sum_{k=1}^{n}E_{k+1} - \sum_{k=1}^{n}E_{k-1})\\ &amp;= \frac{1}{4}(\sum_{k=2}^{n+1}E_{k} - \sum_{k=0}^{n-1}E_{k})\\ &amp;= \frac{1}{4}(E_{n+1} + E_{n} - E_1 - E_0)\\ &amp;= \frac{1}{4}(E_{n+1} + E_{n} - 2)\\ \end{align} \]</p>
<p>The result can be calculated by iterating until \( E_{n+1} \) is greater than
the limit, so that \( E_n \) is less than the limit, then apply the previous
function.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    e0 = 0
    e1 = 2
    while e1 &lt; limit:
        e0, e1 = e1, 4 * e1 + e0

    return (e1 + e0 - 2) // 4
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fibonacci-and-the-golden-ratio"><a class="header" href="#fibonacci-and-the-golden-ratio">Fibonacci and the golden ratio</a></h1>
<p>Although the number of iterations of the second solution is lower than that of
the first solution, it is possible to do better:</p>
<p>\[ \begin{align} \frac{1}{4}(E_{n+1} + E_{n} - 2) &amp;= \frac{1}{4}(F_{3(n+1)} + F_{3n} - 2)\\ &amp;= \frac{1}{4}(F_{3n+2} + F_{3n+1} + F_{3n} - 2)\\ &amp;= \frac{1}{4}(2F_{3n+2} - 2)\\ &amp;= \frac{1}{2}(F_{3n+2} - 1)\\ \end{align} \]</p>
<p>This does not really change the problem, since we still need to iterate until
\( F_{3n} \) reach the limit and then compute \(\frac{1}{2}(F_
{3n+2} - 1)\).</p>
<p>Actually, the Fibonacci numbers can be approximated with the following
<a href="https://en.wikipedia.org/wiki/Fibonacci_number#Closed-form_expression">equation</a>:</p>
<p>\[ F_{n} = \frac{\varphi^{n} - (-\varphi)^{-n}}{\sqrt{5}} \]</p>
<p>where \( \varphi = \frac{1+\sqrt{5}}{2} \) is the
<a href="https://en.wikipedia.org/wiki/Golden_ratio">golden ratio</a>.</p>
<p>\( -(-\varphi)^{-n} \) can be ignored for large numbers which gives the
equation:</p>
<p>\[ F_{n} = \frac{\varphi^{n}}{\sqrt{5}} \]</p>
<p>The limit is the n-th Fibonacci number such that:</p>
<p>\[ \begin{align} F_{n} &amp;\leqslant M\\ \frac{\varphi ^{n}}{\sqrt{5}} &amp;\leqslant M\\ \varphi ^{n} &amp;\leqslant \sqrt{5} M\\ n\log( \varphi ) &amp;\leqslant \log\left(\sqrt{5} M\right)\\ n &amp;\leqslant \left\lfloor \frac{\log\left(\sqrt{5} M\right)}{\log( \varphi )} \right\rfloor \end{align} \]</p>
<p>The result can be computed with \(\frac{1}{2}(F_{n+2} - 1) \) where \( n =
\left\lfloor \frac{\log\left(\sqrt{5} M\right)}{\log( \varphi )} \right\rfloor
\):</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0002/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def sum_of_even_fibonacci_numbers(limit=4000000):
    golden_ratio = (1 + sqrt(5)) / 2
    n = floor(log(sqrt(5) * limit) / log(golden_ratio))
    fn = round((golden_ratio**(n + 2)) / sqrt(5))

    return (fn - 1) // 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-1"><a class="header" href="#solution-1">Solution</a></h1>
<hr />
<blockquote>
<p>4613732</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem3largest-prime-factora"><a class="header" href="#a-hrefhttpsprojecteulernetproblem3largest-prime-factora"><a href="https://projecteuler.net/problem=3">Largest prime factor</a></a></h1>
<blockquote>
<p>The prime factors of 13195 are 5, 7, 13 and 29.</p>
</blockquote>
<blockquote>
<p>What is the largest prime factor of the number 600851475143 ?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-2"><a class="header" href="#brute-force-2">Brute force</a></h1>
<p>\( i \) is a factor of \( n \) if \( n\ \equiv\ 0\ [i] \), in our case it
is enough to iterate over each number. When a factor is found, we simply divide
\( n \) by that factor and continue as long as \( n \) is greater than one.
When \( n \) is equal to one, we simply return the current factor which is
also the largest.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0003/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_prime_factor(n=600851475143):
    res = 2
    while n != 1:
        if n % res == 0:
            n //= res
        else:
            res += 1

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="two-by-two"><a class="header" href="#two-by-two">Two by Two</a></h1>
<p>Since all primes except 2 are odd and in our case 2 is not a factor of
600851475143, we can start with 3 and iterate two by two, which is not a great
improvement, but this problem has no interesting solution anyway.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0003/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_prime_factor(n=600851475143):
    res = 3
    while n != 1:
        if n % res == 0:
            n //= res
        else:
            res += 2

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-2"><a class="header" href="#solution-2">Solution</a></h1>
<hr />
<blockquote>
<p>6857</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem4largest-palindrome-producta"><a class="header" href="#a-hrefhttpsprojecteulernetproblem4largest-palindrome-producta"><a href="https://projecteuler.net/problem=4">Largest palindrome product</a></a></h1>
<blockquote>
<p>A palindromic number reads the same both ways. The largest palindrome made
from the product of two 3-digit numbers is 9009 = 91 × 99.</p>
</blockquote>
<blockquote>
<p>Find the largest palindrome made from the product of two 3-digit numbers.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-3"><a class="header" href="#brute-force-3">Brute force</a></h1>
<p>We are searching the largest palindrome made from the product of two 3-digit
numbers. Firstly, it is necessary to know when a number is a palindrome. This
can be done easily using python iteration.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def is_palindrome(n):
    return str(n) == str(n)[::-1]
</code></pre>
<p>A better solution exists using modulus and division, but performance is not the
goal here.</p>
<p>The range of 3-digit numbers is \( [100; 999] \), the naive solution will
consist in simply iterate over each number and check which product is the
largest palindrome. A little trick: if \( 100 * 200 \) does not work, \(
200 * 100 \) won't work either, so the second loop starts from the current
number of the first one.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_palindrome_product():
    res = 0
    for x in range(100, 1000):
        for y in range(x, 1000):
            if x * y &gt; res and is_palindrome(x * y):
                res = x * y
                
    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="factorisation-is-the-key"><a class="header" href="#factorisation-is-the-key">Factorisation is the key</a></h1>
<p>We know that the researched number is larger than \( 100*100 = 10000 \)
and smaller than \( 999*999 = 998001 \). So it must be of the form \(
abcba \) or \( abccba \). Let's assume it is of the form \( abccba \), if
it does not work, we'll try with \( abcba \).</p>
<p>\( abccba = 10001a + 10010b + 1100c = 11(9091a + 910b + 100c) \) which means
that the palindrome must be divisible by 11. Since 11 is prime, either \(
100001a \), \( 10010b \) or \( 1100c \) is a multiple of 11, which is why
the iteration can be done 11 by 11.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0004/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_palindrome_product():
    res = 0
    for x in range(110, 1000, 11):
        for y in range(x, 1000):
            if x * y &gt; res and is_palindrome(x * y):
                res = x * y

    return res
</code></pre>
<p>We went from 405450 iterations with the <a href="problems/problem_0004/solution1.html">Brute force</a> to 36450
iterations !</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="with-pen-and-paper"><a class="header" href="#with-pen-and-paper">With pen and paper</a></h1>
<p>In <a href="problems/problem_0004/solution2.html">Factorisation is the key</a>, we assume that the number was of
the form \( abccba \). Since it is the factor of two 3-digit number, we have :</p>
<p>\[ \begin{align} abccba &amp;= (100a + 10b + c)(100d + 10e + f)\\ &amp;= 10000ad + 1000(bd + ae) + 100(cd + be + af) + 10(ce + bf) + cf \end{align} \]</p>
<p>Assuming the first digit is 9, then \( cf \) must be equal to 9 as well.</p>
<p>The only ways to make the last digit nine are:</p>
<p>\[ 1 * 9\\ 3 * 3\\ 7 * 7 \]</p>
<p>Thus, both number must start with 9 and end with either 1, 3, 7 or 9. We also
know that \( 100a + 10b + c \) or \( 100d + 10e + f \) is divisible by 11.
The only numbers divisible by 11 and ending with 1, 3, 7 or 9 in the
\( [900; 999]
\) are :</p>
<p>\[ 913\\ 957\\ 979 \]</p>
<p>This give us:</p>
<p>\[ \text{a = 9}\\ \text{b = 1, 5 or 7}\\ \text{c = 3, 7 or 9}\\ \]</p>
<p>Resulting in the numbers:</p>
<p>\[
(900 + 10 + 3)(900 + 10e + 3) = 824439 + 9130x\\
(900 + 50 + 7)(900 + 10e + 7) = 867999 + 9570x\\
(900 + 70 + 9)(900 + 10e + 1) = 882079 + 9790x \]</p>
<p>The first number implies that \( e \) is equal to 9 because if \( e \) was
equal to 8, then \(824439 * 9130 * 8 = 897479 \) would not start with 9.
With \( e = 9 \) we have \( 913 * 993 \) which is the correct answer. Both
\( (900 + 50 + 7)(900 + 10e + 7) \) and \( (900 + 70 + 9)(900 + 10e + 1) \)
give smaller palindrome.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-3"><a class="header" href="#solution-3">Solution</a></h1>
<hr />
<blockquote>
<p>906609</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem5smallest-multiplea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem5smallest-multiplea"><a href="https://projecteuler.net/problem=5">Smallest multiple</a></a></h1>
<blockquote>
<p>2520 is the smallest number that can be divided by each of the numbers
from 1 to 10 without any remainder.</p>
</blockquote>
<blockquote>
<p>What is the smallest positive number that is evenly divisible by all of
the numbers from 1 to 20?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-4"><a class="header" href="#brute-force-4">Brute force</a></h1>
<p>As always, the brute force solution is quite simple, first determine if a number
is evenly divisible by all numbers from 1 to 20.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def is_evenly_divisible(n):
    for i in range(1, 21):
        if n % i != 0:
            return False
        
    return True
</code></pre>
<p>Then iterate until you find a solution.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def smallest_multiple():
    i = 1
    while not is_evenly_divisible(i):
        i += 1

    return i
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime-factorization"><a class="header" href="#prime-factorization">Prime factorization</a></h1>
<p>The <a href="problems/problem_0005/solution2.html">Brute force</a> is actually very slow. A better solution can be
found using prime factorization. The key is to understand that when \( x \)
divides \( y \) evenly, it is because the prime factors of \( x\) are
contained in \( y \). For example, \( 20 = 2^2 * 5 \) which means that a
number divisible by 20 is also divisible by 2, 4 and 5.</p>
<p>Calculating the prime factorization of each number from 1 to 20 give us:</p>
<p>\[\begin{align} 20 &amp;= 2^2 * 5\\ 19 &amp;= 19\\ 18 &amp;= 2 * 3^2\\ 17 &amp;= 17\\ 16 &amp;= 2^4\\ 15 &amp;= 3 * 5\\ 14 &amp;= 2 * 7\\ 13 &amp;= 13\\ 12 &amp;= 2^2 * 3\\ 11 &amp;= 11\\ \end{align} \]</p>
<p>We can stop here, because 10 is included in 20, 9 in 18, 8 in 16, 7 in 14, 6 in
12, 5 in 20, 4 in 20, 3 in 18, 2 in 20 and 1 in 20.</p>
<p>It gives us the answer: \( 2^4 * 3^2 * 5 * 7 * 11 * 13 * 17 * 19 =
232792560 \).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="least-common-multiple"><a class="header" href="#least-common-multiple">Least common multiple</a></h1>
<p>Actually, the problem is to find
the <a href="https://en.wikipedia.org/wiki/Least_common_multiple#Reduction_by_the_greatest_common_divisor">least common multiple</a>
which is:</p>
<p>\[ LCT(1, 2, ..., N) \]</p>
<p>To find the \( LCT \) of \( 1 \) through \( N \), we need all the primes
\( \leqslant N \). For each prime, we need its maximum power that won't exceed
\( N \). Which can be done easily using logarithms:</p>
<p>\[ \begin{align} p^{k} &amp;\leqslant N\\ k\log( p) &amp;\leqslant \log( N)\\ k&amp;=\left\lfloor \frac{\log( N)}{\log( p)}\right\rfloor\\ \end{align} \]</p>
<p>So the \( LCT \) of \( 1 \) through \( N \) is:</p>
<p>\[ \prod p^{\left\lfloor \frac{\log(N)}{\log(p)} \right\rfloor } \]</p>
<p>We also know that it's pointless to search the maximum power of primes greater
than \( \sqrt{n} \) because it will always be 1.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0005/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def smallest_multiple(n=20):
    # Returns a list of all primes &lt;= n
    primes = sieve.primerange(n + 1)
    sqrt_n, log_n = sqrt(n), log(n)
    res = 1
    for p in primes:
        if p &lt; sqrt_n:
            res *= p**(floor(log_n / log(p)))
        else:
            res *= p

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-4"><a class="header" href="#solution-4">Solution</a></h1>
<hr />
<blockquote>
<p>232792560</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem6sum-square-differencea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem6sum-square-differencea"><a href="https://projecteuler.net/problem=6">Sum square difference</a></a></h1>
<blockquote>
<p>The sum of the squares of the first ten natural numbers is,
\[ 1^2 + 2^2 +...+10^2=385 \]
The square of the sum of the first ten natural number is,
\[ (1+2+...10)^2 = 3025 \]
Hence the difference between the sum of the squares of the first ten
natural numbers and the square of the sum is \( 3025 - 385 = 2640 \)</p>
</blockquote>
<blockquote>
<p>Find the difference between the sum of the squares of the first one 
hundred natural numbers and the square of the sum.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-5"><a class="header" href="#brute-force-5">Brute force</a></h1>
<p>Finding the difference between the sum of the squares and the square of the sum
required two steps:</p>
<p>Find the sum of the squares:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_of_squares(n):
    return sum(i**2 for i in range(1, n + 1))
</code></pre>
<p>And the square of the sum:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def square_of_sum(n):
    return sum(i for i in range(1, n + 1))**2
</code></pre>
<p>Finally, just subtract the square of the sum by the sum of the squares:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def sum_square_difference(n=100):
    return square_of_sum(n) - sum_of_squares(n)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summation-formula"><a class="header" href="#summation-formula">Summation formula</a></h1>
<p>We learned in <a href="problems/problem_0006/../problem_0001/problem.html">Problem 1: Multiples of 3 and 5</a>
that:</p>
<p>\[ \sum{k} = \frac{n(n+1)}{2} \]</p>
<p>This gives the following formula for the square of the sum:</p>
<p>\[ (1+2+...+10)^2 = \left(\sum{k}\right)^2 = \left(\frac{n(n+1)}{2}\right)^2 = \frac{n^2 (n+1)^2}{4} \]</p>
<p>The sum of the squares can be found using the formula:</p>
<p>\[ \sum{k^2} = \frac{n(n+1)(2n+1)}{6} \]</p>
<p>There are many demonstrations to prove this equation, let's just look at one of
them:</p>
<p>\[ \begin{align} ( k-1)^{3} &amp;=k^{3} -3k^{2} +3k-1\\ k^{3} -( k-1)^{3} &amp;=3k^{2} -3k+1\\ \sum _{k=1}^{n}\left( k^{3} -( k-1)^{3}\right) &amp;=\sum _{k=1}^{n} 3k^{2} -3k+1 \\ \sum _{k=1}^{n} k^{3} -\sum _{k=1}^{n}( k-1)^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\sum _{k=1}^{n} k+\sum _{k=1}^{n} 1\\ \sum _{k=1}^{n} k^{3} -\sum _{k=0}^{n-1} k^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\frac{n( n+1)}{2} +n\\ n^{3} &amp;=3\sum _{k=1}^{n} k^{2} -3\frac{n( n+1)}{2} +n\\ \sum _{k=1}^{n} k^{2} &amp;=\frac{1}{3} n^{3} +\frac{n( n+1)}{2} -\frac{1}{3} n\\ \sum _{k=1}^{n} k^{2} &amp;=\frac{n( n+1)( 2n+1)}{6} \end{align} \]</p>
<p>The solution can be found in constant time with these two equations:</p>
<p>\[ \frac{n^2(n+1)^2}{4} - \frac{n(n+1)(2n+1)}{6} = \frac{3n^4+2n^3-3n^2-2n}{12} \]</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0006/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def sum_square_difference(n=100):
    return (3 * n**4 + 2 * n**3 - 3 * n**2 - 2 * n) // 12
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-5"><a class="header" href="#solution-5">Solution</a></h1>
<hr />
<blockquote>
<p>25164150</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem710001st-primea"><a class="header" href="#a-hrefhttpsprojecteulernetproblem710001st-primea"><a href="https://projecteuler.net/problem=7">10001st prime</a></a></h1>
<blockquote>
<p>By listing the first six prime numbers: 2, 3, 5, 7, 11, and 13, we can see that the 6th prime is 13.</p>
</blockquote>
<blockquote>
<p>What is the 10 001st prime number?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-6"><a class="header" href="#brute-force-6">Brute force</a></h1>
<p>A well known and fast way to generate primes is the
<a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve of Eratosthenes</a>.
The only problem is that we need an upper bound, which is not the case here
since we don't know the size of the 10001st prime.</p>
<p>We will have to test the primality of each number, if it is prime, then we store
it, otherwise we continue with the next number until the list of prime numbers
that we stored contains 10001 elements. The last one being the answer.</p>
<p>To determine the primality of a number, we can check if one of the preceding
primes can divide it, if not, the number is prime.</p>
<p>Since even number can not be prime, we can go two by two just like
the <a href="problems/problem_0007/../problem_0003/solution2.html">Two by Two</a> solution
of <a href="problems/problem_0007/../problem_0003/problem.html">Problem 3: Largest prime factor</a>.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    i = 3
    primes = [2]
    while len(primes) &lt; n:
        if all(i % p != 0 for p in primes):  # No divisor in the previous prime.
            primes.append(i)
        i += 2

    return primes[-1]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="almost-six-by-six"><a class="header" href="#almost-six-by-six">Almost six by six</a></h1>
<p>Actually, it is possible to speed up a little the previous program knowing that
every prime \( n &gt; 3 \) is of the form :</p>
<p>\[ 6k+1 \text{ or } 6k-1 \]</p>
<p>Let's try to persuade ourselves that this is true. All prime numbers are of the
form:</p>
<p>\[ 6k - 1\\ 6k\\ 6k+1\\ 6k+2\\ 6k+3\\ 6k+4\\ \]</p>
<p>Nothing amazing, but as we are looking for prime number, we can remove some of
them :</p>
<p>\( 6k \), \( 6k + 2 \) and \( 6k + 4 \) are even number, so they cannot be
prime.</p>
<p>\( 6k + 3 = 3(3k + 1) \) which is divisible by 3 and thus not prime
(except 3).</p>
<p>Which let us with: \( 6k + 1 \) and \( 6k - 1 \).</p>
<p>Thus, we can rewrite the old program to check only those numbers.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    i = 1
    primes = [2, 3]
    while len(primes) &lt; n:
        if all((6 * i - 1) % p != 0 for p in primes):
            primes.append(6 * i - 1)
        if all((6 * i + 1) % p != 0 for p in primes):
            primes.append(6 * i + 1)
        i += 1

    return primes[n - 1]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime-number-theorem"><a class="header" href="#prime-number-theorem">Prime number theorem</a></h1>
<p>As I said in the <a href="problems/problem_0007/solution1.html">Brute force</a> solution, the fasted way to
generate primes is the sieve of eratosthenes, but it requires an upper bound. We
can not find the exact upper bound, but we can have a good approximation using
the <a href="https://en.wikipedia.org/wiki/Prime_number_theorem">Prime number theorem</a>:</p>
<p>\[  \pi(N) \sim \frac{N}{\log(N)} \]</p>
<p>Where \( \pi(N) \) is the
<a href="https://en.wikipedia.org/wiki/Prime-counting_function">prime-counting function</a>
.</p>
<p>This function give the number of primes \( M \) less than or equal to \( N
\), in our case we want to determine \( N \) knowing \( M \). Which give us
another formula:</p>
<p>\[ \begin{align} \frac{N}{\log(N)} &amp;\leqslant M\\ \frac{\log(N)}{N} &amp;\leqslant \frac{1}{M}\\ -\frac{\log(N)}{N} &amp;\leqslant -\frac{1}{M}\\ -\frac{\log(N)}{e^{\log(N)}} &amp;\leqslant -\frac{1}{M}\\ -\log(N)e^{-\log(N)} &amp;\leqslant -\frac{1}{M} \end{align} \]</p>
<p>The <a href="https://en.wikipedia.org/wiki/Lambert_W_function">Lambert \( W \) function</a>
says that \( we^w = z \Leftrightarrow w = \mathit{W}_{k}(z) \). This give us:</p>
<p>\[ \begin{align} -\log( N) e^{-\log( N)} &amp;\leqslant -\frac{1}{M}\\ -\log( N) &amp;\leqslant W_{k}\left( -\frac{1}{M}\right)\\ N &amp;\leqslant e^{-W_{k}\left( -\frac{1}{M}\right)} \end{align} \]</p>
<p>The solutions of Lambert's \( W \) function with real number can be found with
ony two branches: \( W_0 \) and \( W_{-1} \) suffice.</p>
<p>For real number \( z \) and \( w \) the equation \( we^w = z \) can be
solved for \( w \) only if \( w \geqslant -\frac{1}{e} \). if \( z
\geqslant 0 \) we get \( w = W_0(z) \) and the two values \( w = W_0(z) \)
and \( w = W_{-1}(z) \) if \( -\frac{1}{e} \leqslant w &lt; 0 \).</p>
<p>We have \( w = -\log(N) \) so we are in the second case. We need to determine
which of \(W_0(z) \) and \( W_{-1}(z) \) is the right formula.</p>
<p>The branch 0 converge to 1 when \( z \) converge to 0. Actually, for \( M &gt;
3 \) we have \( \lceil W_k(-\frac{1}{M}) \rceil = 1\). It implies that the
good branch is -1.</p>
<p>We can actually build the sieve of eratosthenes with the upper bound \( e^ {-W_
{-1}(-\frac{1}{M})} \). Lambert's \( W \) function cannot be expressed in
terms of
<a href="https://en.wikipedia.org/wiki/Elementary_function">elementary functions</a>, so
the formula cannot be simplified. The value of Lambert's \( W \) function
requires an iterative method to be found, as this is quite a difficult problem
we will use the
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.lambertw.html">lambertw</a>
from <a href="https://docs.scipy.org/doc/scipy/index.html">scipy</a> to determine our upper
bound.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0007/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def n_th_prime(n=10001):
    if n &lt; 3:
        return [2, 3][n - 1]

    limit_pi_1 = ceil(exp(-lambertw(-1 / n, -1).real))
    primes = sieve.primerange(limit_pi_1 + 1)

    return next(islice(primes, n - 1, n))
</code></pre>
<p>Note that <code>sieve.primerange</code> returns a <code>generator</code>, so we use slice to get the
n-th element.</p>
<p>When \( N &lt; 3 \), we have \( -\log(N) \geqslant -\frac{1}{e} \) which means
the Lambert's W function has no solution. We can simply hard-code the case of 1
and 2.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-6"><a class="header" href="#solution-6">Solution</a></h1>
<hr />
<blockquote>
<p>104743</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem8largest-product-in-a-seriesa"><a class="header" href="#a-hrefhttpsprojecteulernetproblem8largest-product-in-a-seriesa"><a href="https://projecteuler.net/problem=8">Largest product in a series</a></a></h1>
<blockquote>
<p>The four adjacent digits in the 1000-digit number that have the greatest
product &gt; are 9 × 9 × 8 × 9 = 5832.</p>
</blockquote>
<blockquote>
<p>\[ \begin{align}\\ 73167176531330624919225119674426574742355349194934\\ 96983520312774506326239578318016984801869478851843\\ 85861560789112949495459501737958331952853208805511\\ 12540698747158523863050715693290963295227443043557\\ 66896648950445244523161731856403098711121722383113\\ 62229893423380308135336276614282806444486645238749\\ 30358907296290491560440772390713810515859307960866\\ 70172427121883998797908792274921901699720888093776\\ 65727333001053367881220235421809751254540594752243\\ 52584907711670556013604839586446706324415722155397\\ 53697817977846174064955149290862569321978468622482\\ 83972241375657056057490261407972968652414535100474\\ 82166370484403199890008895243450658541227588666881\\ 16427171479924442928230863465674813919123162824586\\ 17866458359124566529476545682848912883142607690042\\ 24219022671055626321111109370544217506941658960408\\ 07198403850962455444362981230987879927244284909188\\ 84580156166097919133875499200524063689912560717606\\ 05886116467109405077541002256983155200055935729725\\ 71636269561882670428252483600823257530420752963450\\ \end{align} \]</p>
</blockquote>
<blockquote>
<p>Find the thirteen adjacent digits in the 1000-digit number that have the
greatest product. What is the value of this product?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-7"><a class="header" href="#brute-force-7">Brute force</a></h1>
<p>We are searching for the largest product of 13 adjacent digits in a 1000-digit
number. We want to calculate the product of each 13 adjacent digits and find the
largest one.</p>
<p>The 1000-digit number will be stored in a file, so the first step is to get this
number as a string and remove each trailing newline (\n):</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0008/read_file.py">read_file.py</a>:</p>
<pre><code class="language-python">def read_file(filename):
    with open(filename, 'r') as file:
        return file.read().replace('\n', '')
</code></pre>
<p>Given this string, we need to calculate the product of 13 adjacent digits, which
can be done easily
using <a href="https://docs.python.org/3/library/math.html#math.prod">math.prod()</a>.
Then, simply repeat this step for all 13 adjacent digits contained in the
1000-digit number and save the maximum of these products.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0008/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_product_in_series(n, adj=13):
    res = 0
    for i in range(len(n) - adj):
        res = max(prod(int(digit) for digit in n[i: i + adj]), res)

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="0-are-useless"><a class="header" href="#0-are-useless">0 are useless</a></h1>
<p>The problem requires calculating a product, a product of something and 0 will
always give a result of 0. Which means that every 13 adjacent digits containing
0 are useless since the result will never be the largest product.</p>
<p>The 1000-digit number can actually be split around each 0, of course if a number
has less than 13 digits it can be deleted.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0008/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def split_series(n):
    return [sub_n for sub_n in n.split(&quot;0&quot;) if len(sub_n) &gt;= 13]
</code></pre>
<p>Another improvement reside in not calculating every product from the start, for
example if we search the product of 3 adjacent digits in 12345, the 3 solutions
are:</p>
<pre><code class="language-python">1*2*3     = 6
  2*3*4   = (6 / 1) * 4 = 24
    3*4*5 = (24 / 3) * 5 = 60
</code></pre>
<p>The second product is the same as the first, just divide the digit that is not
present and multiply the one that is. We have to be careful with the digit 0
because division by 0 is an error, but we have already solved the problem just
before, so we can assume our number will never contain the digit 0.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0008/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_product_in_series(n, adj=13):
    res = 0
    current = prod(int(digit) for digit in n[0: adj])
    for i in range(len(n) - adj):
        current = (current // int(n[i])) * int(n[i + adj])
        res = max(res, current)

    return res
</code></pre>
<p>We simply repeat this step for each sub-number of the 1000-digit split around 0.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0008/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def largest_product_in_multiples_series(sub_n, adj=13):
    res = 0
    for n in sub_n:
        res = max(largest_product_in_series(n, adj), res)
    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-7"><a class="header" href="#solution-7">Solution</a></h1>
<hr />
<blockquote>
<p>23514624000</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem9special-pythagorean-tripleta"><a class="header" href="#a-hrefhttpsprojecteulernetproblem9special-pythagorean-tripleta"><a href="https://projecteuler.net/problem=9">Special Pythagorean triplet</a></a></h1>
<blockquote>
<p>A Pythagorean triplet is a set of three natural numbers, a &lt; b &lt; c, for which,
\[ a^2 + b ^2 = c^2 \]
For example, \( 3^2 + 4^2 = 9 + 16 = 25 = 5^2. \)</p>
</blockquote>
<blockquote>
<p>There exists exactly one Pythagorean triplet for which a + b + c = 1000.<br />
Find the product abc.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-8"><a class="header" href="#brute-force-8">Brute force</a></h1>
<p>We are searching for \( a \), \( b \) and \( c \) such that \( a &lt; b
&lt; c \), \( a + b + c = 1000 \) and \( a^2 + b^2 = c^2 \). The brute force
solution will simply iterate to 1000 for \( a \), \( b \)
and \( c \) and stop when the above equations are true.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0009/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def special_pythagorean_triplet():
    for a in range(1001):
        for b in range(a + 1, 1001):
            for c in range(b + 1, 1001):
                if a + b + c == 1000 and a**2 + b**2 == c**2:
                    return a * b * c
               
    return -1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="with-a-little-thought"><a class="header" href="#with-a-little-thought">With a little thought</a></h1>
<p>The <a href="problems/problem_0009/solution1.html">Brute force solution</a> can be simplified a bit knowing that
\( a + b + c = 1000 \) implies \( c = 1000 - a - b \). This removes a for
loop and an equation, since \( a + b + c = 1000 \) will always be true.</p>
<p>Another simplification can be made by knowing that \( a &lt; b &lt; c \). This
implies that \( a \), \( b \) and \( c \) are lower than 500, otherwise
\( a + b + c \) will be greater than 1000.</p>
<p>This gives us the following :</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0009/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def special_pythagorean_triplet():
    for a in range(501):
        for b in range(a + 1, 501):
            c = 1000 - a - b
            if a**2 + b**2 == c**2:
                return a * b * c

    return -1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prime-pythagorean-triples"><a class="header" href="#prime-pythagorean-triples">Prime Pythagorean triples</a></h1>
<p>Given an arbitrary pair of integers m and n with m &gt; n &gt; 0. Euclid's formula
states that the integers :</p>
<p>\[ a = m^2 - n^2,\ b=2mn,\ c=m^2+n^2 \]</p>
<p>form a Pythagorean triple: \( a^2 + b^2 = c^2 \)</p>
<p>If we calculate \( a^2 + b ^2 \):</p>
<p>\[ a^2 + b^2 = (m^2-n^2)^2 + (2mn)^2 = m^2 + 4m^2n^2 - 2m^2n^2 + n^2 = (m^2 + n^2)^2 = c^2 \]</p>
<p>Which is coherent, the problem changes from finding \( a \), \( b \) and \(
c \) to finding \( m \) and \( n \), we have:</p>
<p>\[ \begin{align} a+b+c &amp;= 1000\\ 2mn + 2m^2 &amp;= 1000\\ n &amp;= \frac{500}{m} - m\\ \end{align} \]</p>
<p>We have \( m &gt; n \) since b must be positive, solving \( n = m \) gives:</p>
<p>\[ \begin{align} m &amp;= \frac{500}{m} - m\\ 0 &amp;= \frac{500 - 2m^2}{m}\\ 0 &amp;= 500 - 2m^2\\ m &amp;= \sqrt(250)\\ \end{align} \]</p>
<p>Resulting in:</p>
<p>\[ m &gt; 16 &gt; \sqrt(250) \]</p>
<p>We also have \( n &gt; 0 \), solving \( n = 0 \) gives:</p>
<p>\[ \begin{align} 0 &amp;= \frac{500}{m} - m\\ 0 &amp;= 500 - m^2\\ m &amp;= \sqrt(500)\\ \end{align} \]</p>
<p>Resulting in:</p>
<p>\[ m &lt; \sqrt(500) &lt; 23 \]</p>
<p>We also know that \( \frac{500}{m} \) is an integer, so m must divide \(
500 \). The only multiple of that divides \( 500 \) with the constraint \(
16 &gt; m &gt; 23 \) is 20. Having \( m = 20 \) result in \( n = 5 \). It gives
\( a = 200 \), \( b = 375 \) and \( c \) = 425.</p>
<p>The solution can also be found by using a for loop to find \( m \) and \(
n \) with the above constraints.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0009/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def special_pythagorean_triplet():
    for m in range(16, 24):
        for n in range(1, m):
            if m * (n + m) == 500:
                return 2 * m * n * (m**4 - n**4)

    return -1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-8"><a class="header" href="#solution-8">Solution</a></h1>
<hr />
<blockquote>
<p>31875000</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem10summation-of-primesa"><a class="header" href="#a-hrefhttpsprojecteulernetproblem10summation-of-primesa"><a href="https://projecteuler.net/problem=10">Summation of primes</a></a></h1>
<blockquote>
<p>The sum of the primes below \( 10 \) is \( 2 + 3 + 5 + 7 = 17 \).</p>
</blockquote>
<blockquote>
<p>Find the sum of all the primes below two million.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-9"><a class="header" href="#brute-force-9">Brute force</a></h1>
<p>We already know, thanks to te previous problems that when one search for all
prime numbers below a certain limit, the sieve of eratosthenes is a good
solution.</p>
<p>It is enough to sum the list of the primes found with the sieve.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0010/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def summation_of_primes(limit=2000000):
    return sum(sieve.primerange(limit))
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="summation-minus-summation"><a class="header" href="#summation-minus-summation">Summation minus summation</a></h1>
<p>The sieve of eratosthenes is actually quite slow, it's possible to find a better
solution if we consider that we don't need to know all the primes to find their
sum. For example, the sum of the primes less than \( 10 \) is \( 2 + 3 + 5 +
7 = 17 \).</p>
<p>The sum of the primes less than \( 10 \) is the sum of the numbers less than
10 minus the sum of the multiples of the primes less than \( \sqrt{10} \)
plus the primes themselves minus \( 1 \). In this example, the sum of the
multiples of \( 2 \) and \( 3 \):</p>
<p>\[ \begin{alignat}{1} P &amp;&amp;= &amp;&amp;+1&amp;&amp;+2&amp;&amp;+3&amp;&amp;+4&amp;&amp;+5&amp;&amp;+6+7&amp;&amp;+8&amp;&amp;+9&amp;&amp;+10\\ &amp;&amp;&amp;&amp;&amp;&amp;-2&amp;&amp;&amp;&amp;-4&amp;&amp;&amp;&amp;-6&amp;&amp;-8&amp;&amp;&amp;&amp;-10\\ &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;-3&amp;&amp;&amp;&amp;&amp;&amp;-6&amp;&amp;&amp;&amp;-9\\ &amp;&amp;&amp;&amp;-1&amp;&amp;+2&amp;&amp;+3\\ P &amp;&amp;= &amp;&amp;&amp;&amp;+2&amp;&amp;+3&amp;&amp;&amp;&amp;+5&amp;&amp;-6+7\\ \end{alignat} \]</p>
<p>There is just one problem, the number \( 6 \) is both a multiple of \( 2 \)
and \( 3 \). This means we have to remove the multiple of \( 3 \) but not
the multiple of \( 6 \). For numbers larger than 10, if we continue with \( 5
\) we have to remove the multiple of \( 5 \) but not the multiple of \(
2*5=10 \), \( 3*5=15 \) and \( 5*6=30 \).</p>
<p>Let \( \phi(n) \) be the sum of the numbers less than \( n \).</p>
<p>We have the following sequence:</p>
<p>\[ \begin{align} T_0(n) &amp;= \phi(\left\lfloor n \right\rfloor) &amp;&amp;= 1+2+3+\dots\\ T_1(n) &amp;= 2\left(T_0\left(\frac{n}{2}\right)\right) = 2\phi\left (\left\lfloor \frac{n} {2} \right\rfloor \right) &amp;&amp;= 2+4+6+\dots\\ T_2(n) &amp;= 3\left(T_0\left(\frac{n}{3}\right) - T_1\left(\frac{n}{3}\right) \right) = 3\phi \left(\left\lfloor \frac{n}{3} \right\rfloor\right) - 6\phi\left(\left\lfloor \frac{n}{6} \right\rfloor\right) &amp;&amp;= 3+9+15+\dots\\ T_3(n) &amp;= 5\left(T_0\left(\frac{n}{5}\right) - T_1\left(\frac{n}{5}\right) - T_2\left(\frac{n}{5}\right) \right) = 5\phi\left(\left\lfloor\frac{n}{5}\right\rfloor\right) - 10\phi\left(\left\lfloor\frac{n}{10}\right\rfloor\right) - 15\phi\left(\left\lfloor\frac{n}{15} \right\rfloor\right) + 30\phi\left(\left\lfloor\frac{n}{30} \right\rfloor\right) &amp;&amp;= 5+25+35+\dots\\ \end{align} \]</p>
<p>So the k-th term is:</p>
<p>\[ T_k(n) = p_k\left(T_0\left(\frac{n}{p_k}\right) - \dots - T_{k-1}\left (\frac{n} {p_k}\right)\right) \]</p>
<p>Where \( p_k \) is the k-th prime.</p>
<p>We can create a function to find \( T_k \) if we have \( p_k \):</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0010/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def tk(n, k):
    pk = primes[k - 1]
    t0 = phi(floor(n / pk))
    tn = sum([tk(n / pk, i) for i in range(1, k)])
    return pk * (t0 - tn)
</code></pre>
<p>The sum of the primes less than \( n \) is the sum of the numbers less than
\( n \) minus the sum of all the multiples of the primes less than \( \sqrt
{n} \) plus the primes themselves minus \( 1 \):</p>
<p>\[ \left(T_0(n) - T_1(n) - \dots - T_k(n)\right) + \left(p_1 + p_2 + \dots + p_k\right) - 1 \]</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0010/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def summation_of_primes(limit=2000000):
    phi = lambda x: x * (x + 1) // 2
    primes = list(sieve.primerange(floor(sqrt(limit)) + 1))

    def tk(n, k):
        pk = primes[k - 1]
        t0 = phi(floor(n / pk))
        tn = sum([tk(n / pk, i) for i in range(1, k)])
        return pk * (t0 - tn)

    return phi(limit) - sum([tk(limit, i + 1) for i in range(len(primes))]) \
           + sum(primes) - 1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dynamic-programming"><a class="header" href="#dynamic-programming">Dynamic programming</a></h1>
<p>The <a href="problems/problem_0010/solution2.html">Summation minus summation</a> solution gives an interesting
solution because we found the sum of the primes less than \( n \) with only
the primes less than \( \sqrt{n} \). Unfortunately, this solution is not
efficient because it requires too much recursion for larger n.</p>
<p>The main problem with the previous solution was to remove the numbers that were
multiples of previous primes. For example with the multiples of \( 3 \), the
number \( 6 \) was already removed by the multiples of \( 2 \).</p>
<p>What we really want is to remove the multiples of \( 3 \) that have not
already been removed by the multiples of \( 2 \) such as \( 6 \), \( 12 \)
... For \( 5 \) that would be the number that are neither multiples of \( 2
\) nor \( 3 \).</p>
<p>Instead of the sum of the multiples of a prime, we will search for the sum of
integer that remain after sieving with all primes smaller than the current one.</p>
<p>This solution is well explained by <strong>Lucy_Hedgehog</strong> in this
<a href="https://projecteuler.net/thread=10;page=5#111677">thread</a> (only available if
you solve the problem):</p>
<blockquote>
<p>The main idea is as follows: Let \( S(v,m) \) be the sum of integers in the
range \( 2 \dots v \) that remain after sieving with all primes smaller or
equal than \( m \). That is \( S(v,m) \) is the sum of integers up to
\( v \) that are either prime or the product of primes larger than \( m
\).</p>
</blockquote>
<blockquote>
<p>\( S(v, p) \) is equal to \(S(v, p-1) \) if \( p \) is not prime or
\( v \) is smaller than \( p*p \). Otherwise (\( p \) prime, \(
p*p\leqslant v \)) \( S(v,p) \) can be computed from \(S(v, p-1)\)
by finding the sum of integers that are removed while sieving with \( p
\). An integer is removed in this step if it is the product of \(p \)
with another integer that has no divisor smaller than \(p \). This can
be expressed as</p>
</blockquote>
<blockquote>
<p>\[ S\left(v, p \right) = S\left(v, p - 1\right) - p\left(S\left(\frac{v}{p},
p - 1\right) -S\left(p-1, p-1\right)\right) \]</p>
</blockquote>
<blockquote>
<p>Dynamic programming can be used to implement this. It is sufficient to
compute \( S(v,p) \) for all positive integers \( v \) that are
representable as \( \left\lfloor\frac{n}{k}\right\rfloor \) for some
integer \( k \) and all.</p>
</blockquote>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0010/solution3.py">solution3.py</a>:</p>
<pre><code class="language-python">def partial_prime_sum(n=2000000):
    r = ceil(sqrt(n))
    V = [n // i for i in range(1, r + 1)]
    V += list(range(V[-1] - 1, 0, -1))
    S = {i: i * (i + 1) // 2 - 1 for i in V}
    for p in range(2, r + 1):
        if S[p] &gt; S[p - 1]:  # p is prime
            sp = S[p - 1]  # sum of primes smaller than p
            p2 = p * p
            for v in V:
                if v &lt; p2: break
                S[v] -= p * (S[v // p] - sp)
    return S[n]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-9"><a class="header" href="#solution-9">Solution</a></h1>
<hr />
<blockquote>
<p>142913828922</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem11largest-product-in-a-grida"><a class="header" href="#a-hrefhttpsprojecteulernetproblem11largest-product-in-a-grida"><a href="https://projecteuler.net/problem=11">Largest product in a grid</a></a></h1>
<blockquote>
<p>In the 20×20 grid below, four numbers along a diagonal line have been marked in red.</p>
</blockquote>
<blockquote>
<p>\[ 08\ 02\ 22\ 97\ 38\ 15\ 00\ 40\ 00\ 75\ 04\ 05\ 07\ 78\ 52\ 12\ 50\ 77\ 91\ 08\\ 49\ 49\ 99\ 40\ 17\ 81\ 18\ 57\ 60\ 87\ 17\ 40\ 98\ 43\ 69\ 48\ 04\ 56\ 62\ 00\\ 81\ 49\ 31\ 73\ 55\ 79\ 14\ 29\ 93\ 71\ 40\ 67\ 53\ 88\ 30\ 03\ 49\ 13\ 36\ 65\\ 52\ 70\ 95\ 23\ 04\ 60\ 11\ 42\ 69\ 24\ 68\ 56\ 01\ 32\ 56\ 71\ 37\ 02\ 36\ 91\\ 22\ 31\ 16\ 71\ 51\ 67\ 63\ 89\ 41\ 92\ 36\ 54\ 22\ 40\ 40\ 28\ 66\ 33\ 13\ 80\\ 24\ 47\ 32\ 60\ 99\ 03\ 45\ 02\ 44\ 75\ 33\ 53\ 78\ 36\ 84\ 20\ 35\ 17\ 12\ 50\\ 32\ 98\ 81\ 28\ 64\ 23\ 67\ 10\ \color{red}{26}\ 38\ 40\ 67\ 59\ 54\ 70\ 66\ 18\ 38\ 64\ 70\\ 67\ 26\ 20\ 68\ 02\ 62\ 12\ 20\ 95\ \color{red}{63}\ 94\ 39\ 63\ 08\ 40\ 91\ 66\ 49\ 94\ 21\\ 24\ 55\ 58\ 05\ 66\ 73\ 99\ 26\ 97\ 17\ \color{red}{78}\ 78\ 96\ 83\ 14\ 88\ 34\ 89\ 63\ 72\\ 21\ 36\ 23\ 09\ 75\ 00\ 76\ 44\ 20\ 45\ 35\ \color{red}{14}\ 00\ 61\ 33\ 97\ 34\ 31\ 33\ 95\\ 78\ 17\ 53\ 28\ 22\ 75\ 31\ 67\ 15\ 94\ 03\ 80\ 04\ 62\ 16\ 14\ 09\ 53\ 56\ 92\\ 16\ 39\ 05\ 42\ 96\ 35\ 31\ 47\ 55\ 58\ 88\ 24\ 00\ 17\ 54\ 24\ 36\ 29\ 85\ 57\\ 86\ 56\ 00\ 48\ 35\ 71\ 89\ 07\ 05\ 44\ 44\ 37\ 44\ 60\ 21\ 58\ 51\ 54\ 17\ 58\\ 19\ 80\ 81\ 68\ 05\ 94\ 47\ 69\ 28\ 73\ 92\ 13\ 86\ 52\ 17\ 77\ 04\ 89\ 55\ 40\\ 04\ 52\ 08\ 83\ 97\ 35\ 99\ 16\ 07\ 97\ 57\ 32\ 16\ 26\ 26\ 79\ 33\ 27\ 98\ 66\\ 88\ 36\ 68\ 87\ 57\ 62\ 20\ 72\ 03\ 46\ 33\ 67\ 46\ 55\ 12\ 32\ 63\ 93\ 53\ 69\\ 04\ 42\ 16\ 73\ 38\ 25\ 39\ 11\ 24\ 94\ 72\ 18\ 08\ 46\ 29\ 32\ 40\ 62\ 76\ 36\\ 20\ 69\ 36\ 41\ 72\ 30\ 23\ 88\ 34\ 62\ 99\ 69\ 82\ 67\ 59\ 85\ 74\ 04\ 36\ 16\\ 20\ 73\ 35\ 29\ 78\ 31\ 90\ 01\ 74\ 31\ 49\ 71\ 48\ 86\ 81\ 16\ 23\ 57\ 05\ 54\\ 01\ 70\ 54\ 71\ 83\ 51\ 54\ 69\ 16\ 92\ 33\ 48\ 61\ 43\ 52\ 01\ 89\ 19\ 67\ 48\\ \]</p>
</blockquote>
<blockquote>
<p>The product of these numbers is \( 26 × 63 × 78 × 14 = 1788696 \).</p>
</blockquote>
<blockquote>
<p>What is the greatest product of four adjacent numbers in the same 
direction (up, down, left, right, or diagonally) in the \( 20 \times 20 \) 
grid?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-10"><a class="header" href="#brute-force-10">Brute force</a></h1>
<p>This problem is not interesting, the solution is simply to iterate on each 
row, column and on the two diagonal.</p>
<p>As with <a href="problems/problem_0011/../problem_0008/problem.html">Largest product in a series</a>, the 
input grid will be stored in a file, so the first step is to obtain this
grid as int matrix.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0011/read_file.py">read_file.py</a>:</p>
<pre><code class="language-python">def read_file(filename):
    with open(filename, 'r') as file:
        return [[int(x) for x in line.split(' ')] for line in
                file.read().split('\n')[:-1]]  # Last element is an empty line
</code></pre>
<p>And then just iterate on this matrix:</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0011/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def largest_product_in_grid(filename):
    g = read_file(filename)

    for y in range(0, 20):
        for x in range(0, 17):
            yield g[x][y] * g[x + 1][y] * g[x + 2][y] * g[x + 3][y]
    for x in range(0, 20):
        for y in range(0, 17):
            yield g[x][y] * g[x][y + 1] * g[x][y + 2] * g[x][y + 3]
    for y in range(0, 17):
        for x in range(0, 17):
            yield g[x][y] * g[x + 1][y + 1] * g[x + 2][y + 2] * g[x + 3][y + 3]
    for x in range(3, 20):
        for y in range(0, 17):
            yield g[x][y] * g[x - 1][y + 1] * g[x - 2][y + 2] * g[x - 3][y + 3]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-10"><a class="header" href="#solution-10">Solution</a></h1>
<hr />
<blockquote>
<p>70600674</p>
</blockquote>
<hr />
<div style="break-before: page; page-break-before: always;"></div><h1 id="a-hrefhttpsprojecteulernetproblem12highly-divisible-triangular-numbera"><a class="header" href="#a-hrefhttpsprojecteulernetproblem12highly-divisible-triangular-numbera"><a href="https://projecteuler.net/problem=12">Highly divisible triangular number</a></a></h1>
<blockquote>
<p>The sequence of triangle numbers is generated by adding the natural
numbers. So the 7th triangle number would be \(1 + 2 + 3 + 4 + 5 + 6 + 7
= 28 \). The first ten terms would be:</p>
<p>\[ 1, 3, 6, 10, 15, 21, 28, 36, 45, 55, \dots \]</p>
<p>Let us list the factors of the first seven triangle numbers:</p>
<p>\[
\begin{align}
1&amp;: 1\\
3&amp;: 1,3\\
6&amp;: 1,2,3,6\\
10&amp;: 1,2,5,10\\
15&amp;: 1,3,5,15\\
21&amp;: 1,3,7,21\\
28&amp;: 1,2,4,7,14,28\\
\end{align}
\]</p>
<p>We can see that 28 is the first triangle number to have over five divisors.</p>
<p>What is the value of the first triangle number to have over five hundred divisors?</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="brute-force-11"><a class="header" href="#brute-force-11">Brute force</a></h1>
<p>Finding the number of factors of \( n \) can be done by iterating from 1 to
\( n \) and checking each number that can divide \( n \).</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0012/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def number_of_factors(n):
    res = 1
    for i in range(2, n):
        if n % i == 0:
            res += 1
    return res
</code></pre>
<p><a href="https://en.wikipedia.org/wiki/Triangular_number">Triangular number</a> can be
computed quite easily with a loop, we can generate them as long as their number
of divisor is less than \( 500 \).</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0012/solution1.py">solution1.py</a>:</p>
<pre><code class="language-python">def highly_div_triangular_number(n=500):
    i = 1
    res = 1
    while number_of_factors(res) &lt; n:
        i += 1
        res += i

    return res
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="common-factor"><a class="header" href="#common-factor">Common factor</a></h1>
<p>The <a href="problems/problem_0012/solution1.html">Brute Force</a> solution is really slow, way to slow to be
honest.</p>
<p>First, we can improve the way we find the number of factors. If \( i \)
divides \( n \), then obviously \( \frac{n}{i} \) divides \( n \) too. We
do not need to iterate from 2 to \( n \) but only to \( \sqrt{n} \) and add
the factors two by two. The only exception is that if \( \sqrt{n} \) divides
\( n \) we only need to count it once.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0012/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def number_of_factors(n):
    res = 1
    root = floor(sqrt(n))
    for i in range(2, root):
        if n % i == 0:
            res += 1
    return 2 * res + (root**2 == n)
</code></pre>
<p>This makes the solution much faster, but there is still room for improvement in
the way the triangular numbers are calculated. We already know from the previous
problems that the sum of integer from \( 1 \) to \( n \) is \(\frac{n(n+1)
}{2} \). Since \( n \) and \( n + 1 \) have no factors in common except \(
1 \), we can multiply the number of factor in \( \frac{n}{2} \) and \( n + 1
\) or \( n \) and \( \frac{n+1}{2} \) depending on the parity of \( n \).
This allows us to calculate the number of factors of smaller numbers, which
makes the solution quite fast compared to the <a href="problems/problem_0012/solution1.html">Brute force</a>
solution.</p>
<p>From <a href="https://github.com/TurtleSmoke/Project-Euler/blob/main/problems/problem_0012/solution2.py">solution2.py</a>:</p>
<pre><code class="language-python">def highly_div_triangular_number(n=500):
    i = 0
    factors = 0
    while factors &lt; n:
        i += 1
        if i % 2 == 0:
            factors = number_of_factors(i // 2) * number_of_factors(i + 1)
        else:
            factors = number_of_factors(i) * number_of_factors((i + 1) // 2)

    return i * (i + 1) // 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="solution-11"><a class="header" href="#solution-11">Solution</a></h1>
<hr />
<blockquote>
<p>76576500</p>
</blockquote>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
                
    </body>
</html>
